<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head><link rel="stylesheet" type="text/css" href="description/Combined.css,0:HeaderFooterSprite,0:Header.NonMtps,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;hashKey=C9973DA951AE6202C9B348379A1BE49D" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="description/67b74b86-a273-4ad7-9ed5-0f97276412eaCombined.css,0:HeaderFooterSprite,0:Footer.NonMtps,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;hashKey=F576C687BC536B84D6E5B3246EE39B49" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>Command Target RGB - VS 2013</title>
        <link href="description/Galleries.css" type="text/css" rel="Stylesheet" /><link href="description/Layout.css" type="text/css" rel="Stylesheet" /><link href="description/Brand.css" type="text/css" rel="Stylesheet" />
        <link href="description/iframedescription.css" rel="Stylesheet" type="text/css" />
        <script src="description/offline.js" type="text/javascript"></script>
        <style type="text/css">
            #projectInfo {
                overflow: auto;
            }
            #longDesc {
                clear:both;
                margin: 25px 0 10px 0;
            }

            #SampleIndexList{
                margin-left: 15px;
            }
        </style>
    </head>
<body>
    <div id="offlineDescription">
        <h1>Command Target RGB - VS 2013</h1>
        <br/>
        <div id="projectInfo">
            <div class="section">
                    <div class="itemBarLong tagsContainer">
                        <label for="Technologies">Technologies</label>
                        <div id="Technologies">
                            Visual Studio 2013
                        </div>
                    </div>
                    <div class="itemBarLong tagsContainer">
                        <label for="Topics">Topics</label>
                        <div id="Topics">
                            Extensibility
                        </div>
                    </div>
                <div class="itemBarLong">
                    <label for="Platforms">Platforms</label>
                    <div id="Platforms">
                        Desktop
                    </div>
                </div>
                <div class="itemBarLong">
                    <label for="Requirements">Requirements</label>
                    <div id="Requirements">
                        Microsoft Visual Studio 2013 SDK, Microsoft Visual Studio 2013 SDK
                    </div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Primary language</label>
                    <div id="LastUpdated">en-US</div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Updated</label>
                    <div id="LastUpdated">5/29/2014</div>
                </div>
                <div class="itemBarLong">
                    <label for="License">License</label>
                    <div id="License">
                        <a href="license.rtf">Apache License, Version 2.0</a></div>
                </div>
                <div class="itemBar">
                    <div class="viewonlinecont">
                        <a data-link="online" href="http://code.msdn.microsoft.com/Command-Target-RGB-VS-2013-00fdf8de">View this sample online</a>
                    </div>
                </div>
            </div>
        </div>
        
                   
<script type="text/javascript">
    function initializePage() {
        var otherTabClass = 'otherTab';
        var hiddenPreClass = 'hidden';

        var htmlDecode = function(encodedData) {
            var decodedData = "";
            if (encodedData) {
                var div = document.createElement('div');
                div.innerHTML = encodedData;
                decodedData = div.firstChild.nodeValue.replace( /\\r\\n/ig , '\r\n');
            }
            return decodedData;
        };
                
        Galleries.iterateElem(Galleries.findElem(null, 'div', 'scriptcode'), function (index, scriptBlock) {
            var titleElem = Galleries.findElem(scriptBlock, 'div', 'title')[0];
            var labelElems = Galleries.findElem(titleElem, 'span');
            if (labelElems.length == 0) {
                labelElems = titleElem;
            }
            var languageSpans = Galleries.findElem(scriptBlock, 'span', 'hidden');
            var pres = Galleries.findElem(scriptBlock, 'pre');
            if (languageSpans.length > 0 && pres.length > 1) {
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    var languageSpan = languageSpans[index];
                            
                    elem.code = codePre.innerHTML.replace( /(\r(\n)?)|((\r)?\n)/ig , '\\r\\n');
                            
                    codePre.className = codePre.className.replace(hiddenPreClass, '');
                            
                    languageSpan.parentNode.removeChild(languageSpan);
                });

                pres = Galleries.findElem(scriptBlock, 'pre');
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    if (index == 0) {
                        scriptBlock.activeTab = 0;
                    }
                    else {
                        labelSpan.className += otherTabClass;
                        codePre.className += hiddenPreClass;
                    }
                    Galleries.attachEventHandler(labelSpan, 'click', function(e) {
                        var activeTab = scriptBlock.activeTab;
                        labelElems[activeTab].className += otherTabClass;
                        pres[activeTab].className += hiddenPreClass;

                        codePre.className = codePre.className.replace(hiddenPreClass, '');
                        labelSpan.className = labelSpan.className.replace(otherTabClass, '');
                        scriptBlock.activeTab = index;
                    });
                });

                var preview = Galleries.findElem(scriptBlock, 'div', 'preview');
                if (preview.length == 0) {
                    preview.push(pres[pres.length - 1]);
                }
                Galleries.iterateElem(preview, function(index, elem) {
                    elem.parentNode.removeChild(elem);
                });

                if (window.clipboardData && clipboardData.setData) {
                    var copyLink = document.createElement('a');
                    copyLink.href = 'javascript:void(0);';
                    copyLink.className = 'copyCode';
                    copyLink.innerHTML = 'Copy code';
                    Galleries.attachEventHandler(copyLink, 'click', function (e) {
                        clipboardData.setData("Text", htmlDecode(labelElems[scriptBlock.activeTab].code));
                        return false;
                    });
                    scriptBlock.insertBefore(copyLink, scriptBlock.childNodes[0]);
                }
            }
        });
    }

    Galleries.onWindowLoad(function(){
        initializePage();
    });

</script>
<div id="longDesc">
    
<div id="longDesc">
<h1><span>Introduction</span></h1>
<p>A Visual Studio Package which provides a multi-instance tool window called &quot;Red Green Blue&quot; which hosts a toolbar with three buttons that will change the tool window's background color and move the toolbar in the frame.</p>
<h1><span>Getting Started</span></h1>
<p>To build and run this sample, you must have Visual Studio 2013 installed, as well as the Visual Studio SDK. Unzip the CommandTargetRGB.zip file into your Visual Studio Projects directory (My Documents\Visual Studio 2013\Projects) and open the CommandTargetRGB.sln
 solution.</p>
<h1><span>Building the Sample</span></h1>
<p>To build the sample, make sure the CommandTargetRGB solution is open and then use the Build | Build Solution menu command.</p>
<h1><span>Running the Sample</span></h1>
<p>To run the sample, hit F5 or choose the Debug | Start Debugging menu command. A new instance of Visual Studio will launch under the experimental hive. The experimental hive is a special &quot;sandbox&quot; instance of Visual Studio that allows you to develop and test
 packages without affecting your main instance of Visual Studio. Once loaded, choose the View | Other Windows | Red Green Blue menu command. A new tool window called &quot;Red Green Blue&quot; will open with a red background and a toolbar with three commands. Because
 this is a multi-instance tool window, each time you choose the Red Green Blue menu command, a new tool window will appear.</p>
<p>The three commands are called Red, Green, and Blue, and they each change the background color of the tool window they are contained in. To demonstrate the flexibility of this toolbar, each command also docks the toolbar to the top, bottom, or left side of
 the tool window.</p>
<h1><span>Source Code Overview</span></h1>
<p>The source code in this sample demonstrates several techniques you can use to write your own packages:</p>
<ul>
<li>How to create a multi-instance tool window for your package </li><li>How to style the content of a WPF control in a tool window </li><li>How to handle commands from the tool window toolbar </li><li>How to programmatically add a ToolBarTray to a WPF grid </li></ul>
<p>One of the most interesting aspects of the code for this sample is how the toolbar is created. The RGBToolWindow class uses the IVsUIShell4.CreateToolbarTray method to programmatically create a toolbar tray, passing itself as the IOleCommandTarget for the
 toolbar. Since each tool window is an independent instance of the RGBToolWindow class, each tool window can respond to its three toolbar commands independently without affecting the other instances of the Red Green Blue tool window.</p>
<h1><span>Project Files</span></h1>
<ul>
<li>CommandTargetRGB.vsct - Defines the menu item, toolbar, and toolbar commands for the sample.
</li><li>CommandTargetRGBPackage.cs/vb - Implements the Visual Studio Package, which creates and responds to the &quot;Red Green Blue&quot; menu command.
</li><li>RGBControl.xaml - Defines the XAML layout for the WPF RGBControl. </li><li>RGBControl.xaml.cs/vb - Implements the code-behind for the RGBControl. </li><li>RGBToolWindow.cs/vb - Defines the tool window pane, creates the toolbar, and responds to IOleCommandTarget commands.&nbsp;
</li></ul>
</div>

</div>


    </div>
</body>
</html>

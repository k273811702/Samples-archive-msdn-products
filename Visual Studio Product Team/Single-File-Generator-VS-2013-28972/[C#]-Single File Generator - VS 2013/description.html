<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head><link rel="stylesheet" type="text/css" href="description/Combined.css,0:HeaderFooterSprite,0:Header.NonMtps,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;hashKey=C9973DA951AE6202C9B348379A1BE49D" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="description/1b88b18a-5268-4861-9da2-6c6e2539edaaCombined.css,0:HeaderFooterSprite,0:Footer.NonMtps,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;hashKey=F576C687BC536B84D6E5B3246EE39B49" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>Single File Generator - VS 2013</title>
        <link href="description/Galleries.css" type="text/css" rel="Stylesheet" /><link href="description/Layout.css" type="text/css" rel="Stylesheet" /><link href="description/Brand.css" type="text/css" rel="Stylesheet" />
        <link href="description/iframedescription.css" rel="Stylesheet" type="text/css" />
        <script src="description/offline.js" type="text/javascript"></script>
        <style type="text/css">
            #projectInfo {
                overflow: auto;
            }
            #longDesc {
                clear:both;
                margin: 25px 0 10px 0;
            }

            #SampleIndexList{
                margin-left: 15px;
            }
        </style>
    </head>
<body>
    <div id="offlineDescription">
        <h1>Single File Generator - VS 2013</h1>
        <br/>
        <div id="projectInfo">
            <div class="section">
                    <div class="itemBarLong tagsContainer">
                        <label for="Technologies">Technologies</label>
                        <div id="Technologies">
                            Visual Studio 2013
                        </div>
                    </div>
                    <div class="itemBarLong tagsContainer">
                        <label for="Topics">Topics</label>
                        <div id="Topics">
                            Extensibility
                        </div>
                    </div>
                <div class="itemBarLong">
                    <label for="Platforms">Platforms</label>
                    <div id="Platforms">
                        Desktop
                    </div>
                </div>
                <div class="itemBarLong">
                    <label for="Requirements">Requirements</label>
                    <div id="Requirements">
                        Microsoft Visual Studio 2013 SDK, Microsoft Visual Studio 2013 SDK
                    </div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Primary language</label>
                    <div id="LastUpdated">en-US</div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Updated</label>
                    <div id="LastUpdated">5/29/2014</div>
                </div>
                <div class="itemBarLong">
                    <label for="License">License</label>
                    <div id="License">
                        <a href="license.rtf">Apache License, Version 2.0</a></div>
                </div>
                <div class="itemBar">
                    <div class="viewonlinecont">
                        <a data-link="online" href="http://code.msdn.microsoft.com/Single-File-Generator-VS-f64b7d0a">View this sample online</a>
                    </div>
                </div>
            </div>
        </div>
        
                   
<script type="text/javascript">
    function initializePage() {
        var otherTabClass = 'otherTab';
        var hiddenPreClass = 'hidden';

        var htmlDecode = function(encodedData) {
            var decodedData = "";
            if (encodedData) {
                var div = document.createElement('div');
                div.innerHTML = encodedData;
                decodedData = div.firstChild.nodeValue.replace( /\\r\\n/ig , '\r\n');
            }
            return decodedData;
        };
                
        Galleries.iterateElem(Galleries.findElem(null, 'div', 'scriptcode'), function (index, scriptBlock) {
            var titleElem = Galleries.findElem(scriptBlock, 'div', 'title')[0];
            var labelElems = Galleries.findElem(titleElem, 'span');
            if (labelElems.length == 0) {
                labelElems = titleElem;
            }
            var languageSpans = Galleries.findElem(scriptBlock, 'span', 'hidden');
            var pres = Galleries.findElem(scriptBlock, 'pre');
            if (languageSpans.length > 0 && pres.length > 1) {
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    var languageSpan = languageSpans[index];
                            
                    elem.code = codePre.innerHTML.replace( /(\r(\n)?)|((\r)?\n)/ig , '\\r\\n');
                            
                    codePre.className = codePre.className.replace(hiddenPreClass, '');
                            
                    languageSpan.parentNode.removeChild(languageSpan);
                });

                pres = Galleries.findElem(scriptBlock, 'pre');
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    if (index == 0) {
                        scriptBlock.activeTab = 0;
                    }
                    else {
                        labelSpan.className += otherTabClass;
                        codePre.className += hiddenPreClass;
                    }
                    Galleries.attachEventHandler(labelSpan, 'click', function(e) {
                        var activeTab = scriptBlock.activeTab;
                        labelElems[activeTab].className += otherTabClass;
                        pres[activeTab].className += hiddenPreClass;

                        codePre.className = codePre.className.replace(hiddenPreClass, '');
                        labelSpan.className = labelSpan.className.replace(otherTabClass, '');
                        scriptBlock.activeTab = index;
                    });
                });

                var preview = Galleries.findElem(scriptBlock, 'div', 'preview');
                if (preview.length == 0) {
                    preview.push(pres[pres.length - 1]);
                }
                Galleries.iterateElem(preview, function(index, elem) {
                    elem.parentNode.removeChild(elem);
                });

                if (window.clipboardData && clipboardData.setData) {
                    var copyLink = document.createElement('a');
                    copyLink.href = 'javascript:void(0);';
                    copyLink.className = 'copyCode';
                    copyLink.innerHTML = 'Copy code';
                    Galleries.attachEventHandler(copyLink, 'click', function (e) {
                        clipboardData.setData("Text", htmlDecode(labelElems[scriptBlock.activeTab].code));
                        return false;
                    });
                    scriptBlock.insertBefore(copyLink, scriptBlock.childNodes[0]);
                }
            }
        });
    }

    Galleries.onWindowLoad(function(){
        initializePage();
    });

</script>
<div id="longDesc">
    
<h2>Introduction</h2>
<p>This sample demonstrates how to build a single file generator.<br>
<br>
</p>
<ul>
<li>Shows how to implement a single file generator. </li><li>Shows how to use CodeDom to generate source code in Visual Basic, C# </li></ul>
<p>&nbsp;</p>
<h2><strong>Quick Navigation</strong></h2>
<table border="0">
<tbody>
<tr>
<td>1 <a href="http://code.msdn.microsoft.com/SingleFileGenerator#Req">Requirements</a></td>
</tr>
<tr>
<td>2 <a href="http://code.msdn.microsoft.com/SingleFileGenerator#downloadAndInstall">
Download and Install</a></td>
</tr>
<tr>
<td>3 <a href="http://code.msdn.microsoft.com/SingleFileGenerator#BuildAndRun">Building and Running</a></td>
</tr>
<tr>
<td>4 <a href="http://code.msdn.microsoft.com/SingleFileGenerator#GettingStarted">
Getting Started</a></td>
</tr>
<tr>
<td>4.1 <a href="http://code.msdn.microsoft.com/SingleFileGenerator#ProjFiles">Project Files</a></td>
</tr>
<tr>
<td>4.2 <a href="http://code.msdn.microsoft.com/SingleFileGenerator#FuncTests">Functional Tests</a></td>
</tr>
<tr>
<td>4.3 <a href="http://code.msdn.microsoft.com/SingleFileGenerator#Status">Status</a></td>
</tr>
<tr>
<td>4.4 <a href="http://code.msdn.microsoft.com/SingleFileGenerator#AddResx">Additional Resources</a></td>
</tr>
</tbody>
</table>
<p><span id="ctl00_ctl00_Content_TabContentPanel_Content_wikiSourceLabel"><br>
</span></p>
<h2>Requirements</h2>
<p><a class="externalLink" href="http://msdn.com/vstudio">Visual Studio 2013 and Visual Studio 2013 SDK</a><br>
<br>
</p>
<h2>Download and Install</h2>
<ul>
<li>Go to the &quot;Downloads tab&quot; and download the zip file associated with this sample
</li><li>Unzip the sample to your machine </li><li>Double click on the .sln file to launch the solution </li></ul>
<p>&nbsp;</p>
<h2>Building and Running</h2>
<p>To build and execute the sample, press F5 after the sample is loaded. This will launch the experimental hive which will demonstrate the sample's function. In Visual Studio, create a new project, e.g. WindowsApplication. Add a new XML file to the project,
 using the schema from XmlClassGeneratorSchema.xsd file (e.g. you can use the Example.XmlFile.xml member of the solution). Open the Properties window for the xml file and set CustomTool to &quot;XmlClassGenerator&quot;. Save the xml file and this should trigger the single
 file generator to run on the xml file. If there are no generation errors, a CS/VB file with the same name as the xml file will be created and added to the project. If there are errors, they will be reported in ErrorList toolwindow.<br>
<br>
</p>
<h2>Getting Started</h2>
<p>The sample shows how to implement a single file generator. It demonstrates leveraging CodeDom to generate source code in Visual Basic, C#. It also demonstrates how to validate a XML document against a schema and communicate errors through the Error List.<br>
<br>
</p>
<h2>Project Files</h2>
<p>&nbsp;</p>
<table border="1">
<tbody>
<tr>
<th>File Name </th>
<th>Description </th>
</tr>
<tr>
<td><strong>AssemblyInfo</strong></td>
<td>This file contains assembly custom attributes.</td>
</tr>
<tr>
<td><strong>BaseCodeGenerator</strong></td>
<td>Abstract class that implements the IVsSingleFileGenerator interface.</td>
</tr>
<tr>
<td><strong>BaseCodeGeneratorWithSite</strong></td>
<td>Abstract class that inherits from BaseCodeGenerator and implements the IObjectWithSite interface.</td>
</tr>
<tr>
<td><strong>XmlClassGenerator</strong></td>
<td>The single file generator class.</td>
</tr>
<tr>
<td><strong>SourceCodeGenerator</strong></td>
<td>Static class that contains the CodeDom code used to generate source code.</td>
</tr>
<tr>
<td><strong>Support</strong></td>
<td>Static class containing support functions.</td>
</tr>
<tr>
<td><strong>XmlClassGeneratorSchema.xsd</strong></td>
<td>Schema for XML documents that the generator knows how to convert into source code.</td>
</tr>
<tr>
<td><strong>Strings.resx</strong></td>
<td>Resource strings (localizable).</td>
</tr>
</tbody>
</table>
<p><span id="ctl00_ctl00_Content_TabContentPanel_Content_wikiSourceLabel"><br>
</span></p>
<h3>Functional Tests</h3>
<p>&nbsp;</p>
<table border="1">
<tbody>
<tr>
<th>Description </th>
</tr>
<tr>
<td>Load the sample</td>
</tr>
<tr>
<td>Verify the sample builds in Debug Configuration</td>
</tr>
<tr>
<td>Verify the sample builds in Release Configuration</td>
</tr>
<tr>
<td>Verify that the generator is properly registered when building</td>
</tr>
<tr>
<td>Verify that the generator works (C#).</td>
</tr>
<tr>
<td>Verify that the generator works (Visual Basic).</td>
</tr>
<tr>
<td>Verify that the generator works (J#).</td>
</tr>
<tr>
<td>Verify that the generator fails for bad XML (C#).</td>
</tr>
<tr>
<td>Verify that the generator fails for bad XML (Visual Basic).</td>
</tr>
<tr>
<td>Verify that the generator fails for bad XML (J#).</td>
</tr>
</tbody>
</table>
<p><span id="ctl00_ctl00_Content_TabContentPanel_Content_wikiSourceLabel"><br>
</span></p>
<h2>Status</h2>
<p>&nbsp;</p>
<table border="1">
<tbody>
<tr>
<th>Function </th>
<th>Status </th>
</tr>
<tr>
<td>Demonstrates Accessibility</td>
<td>Yes</td>
</tr>
<tr>
<td>Demonstrates Error Handling</td>
<td>No</td>
</tr>
<tr>
<td>Follows SDK Coding Standards</td>
<td>Yes</td>
</tr>
<tr>
<td>Demonstrates Localization</td>
<td>Yes</td>
</tr>
<tr>
<td>Implements Functional Tests</td>
<td>Yes</td>
</tr>
<tr>
<td>Sample supported by Microsoft</td>
<td>Yes</td>
</tr>
<tr>
<td>Implements Unit Tests</td>
<td>False</td>
</tr>
</tbody>
</table>
<p><span id="ctl00_ctl00_Content_TabContentPanel_Content_wikiSourceLabel"><br>
</span></p>
<h4>Additional Resources</h4>
<p>&nbsp;</p>
<p><a id="112" href="http://code.msdn.microsoft.com/site/view/file/112/0/Single_File_Generator_Sample.docx">Single_File_Generator_Sample.docx</a></p>
<p><span id="ctl00_ctl00_Content_TabContentPanel_Content_wikiSourceLabel"><a class="externalLink" href="http://msdn.microsoft.com/en-us/library/bb166508%28VS.100%29.aspx">Implementing and Registering Single File Generators</a></span></p>

</div>


    </div>
</body>
</html>

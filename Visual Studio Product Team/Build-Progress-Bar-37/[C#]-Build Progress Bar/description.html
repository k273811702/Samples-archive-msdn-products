<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head><link rel="stylesheet" type="text/css" href="description/Combined.css,1:ImageSprite;/Areas/Epx/Themes/Msdn/Content:0,/Areas/Epx/Content/Css:1&amp;amp;hashKey=E7560C71640616C5057FAEACB58DCB00" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="description/2f95808e-ca34-4249-88ff-44fabe33cdc0Combined.css,1:LinkList,2:ImageSprite,2:SiteFeedbackLink;/Areas/Epx/Themes/Msdn/Content:0,/Areas/Epx/Themes/Base/Content:1,/Areas/Epx/Content/Css:2&amp;amp;hashKey=EEE39C2D6B93379FDAF50337BE99AF8C" xmlns="http://www.w3.org/1999/xhtml" />

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>Build Progress Bar</title>
        <link href="description/Galleries.css" type="text/css" rel="Stylesheet" /><link href="description/Layout.css" type="text/css" rel="Stylesheet" /><link href="description/Brand.css" type="text/css" rel="Stylesheet" />
        <link href="description/iframedescription.css" rel="Stylesheet" type="text/css" />
        <script src="description/offline.js" type="text/javascript"></script>
        <style type="text/css">
            #projectInfo {
                overflow: auto;
            }
            #longDesc {
                clear:both;
                margin: 25px 0 10px 0;
            }

            #SampleIndexList{
                margin-left: 15px;
            }
        </style>
    </head>
<body>
    <div id="offlineDescription">
        <h1>Build Progress Bar</h1>
        <br/>
        <div id="projectInfo">
            <div class="section">
                    <div class="itemBarLong tagsContainer">
                        <label for="Technologies">Technologies</label>
                        <div id="Technologies">
                            Visual Studio 2010 SDK
                        </div>
                    </div>
                    <div class="itemBarLong tagsContainer">
                        <label for="Topics">Topics</label>
                        <div id="Topics">
                            VSX, Visual Studio Shell
                        </div>
                    </div>
                <div class="itemBarLong">
                    <label for="Platforms">Platforms</label>
                    <div id="Platforms">
                        Desktop
                    </div>
                </div>
                <div class="itemBarLong">
                    <label for="Requirements">Requirements</label>
                    <div id="Requirements">
                        
                    </div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Primary Language</label>
                    <div id="LastUpdated">en-US</div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Last Updated</label>
                    <div id="LastUpdated">3/25/2011</div>
                </div>
                <div class="itemBarLong">
                    <label for="License">License</label>
                    <div id="License">
                        <a href="license.rtf">Apache License, Version 2.0</a></div>
                </div>
                <div class="itemBar">
                    <div class="viewonlinecont">
                        <a data-link="online" href="http://code.msdn.microsoft.com/Build-Progress-Bar-0b182d5f">View this sample online</a>
                    </div>
                </div>
            </div>
        </div>
        
                   
<script type="text/javascript">
    function initializePage() {
        var otherTabClass = 'otherTab';
        var hiddenPreClass = 'hidden';

        var htmlDecode = function(encodedData) {
            var decodedData = "";
            if (encodedData) {
                var div = document.createElement('div');
                div.innerHTML = encodedData;
                decodedData = div.firstChild.nodeValue.replace( /\\r\\n/ig , '\r\n');
            }
            return decodedData;
        };
                
        Galleries.iterateElem(Galleries.findElem(null, 'div', 'scriptcode'), function (index, scriptBlock) {
            var titleElem = Galleries.findElem(scriptBlock, 'div', 'title')[0];
            var labelElems = Galleries.findElem(titleElem, 'span');
            if (labelElems.length == 0) {
                labelElems = titleElem;
            }
            var languageSpans = Galleries.findElem(scriptBlock, 'span', 'hidden');
            var pres = Galleries.findElem(scriptBlock, 'pre');
            if (languageSpans.length > 0 && pres.length > 1) {
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    var languageSpan = languageSpans[index];
                            
                    elem.code = codePre.innerHTML.replace( /(\r(\n)?)|((\r)?\n)/ig , '\\r\\n');
                            
                    codePre.className = codePre.className.replace(hiddenPreClass, '');
                            
                    languageSpan.parentNode.removeChild(languageSpan);
                });

                pres = Galleries.findElem(scriptBlock, 'pre');
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    if (index == 0) {
                        scriptBlock.activeTab = 0;
                    }
                    else {
                        labelSpan.className += otherTabClass;
                        codePre.className += hiddenPreClass;
                    }
                    Galleries.attachEventHandler(labelSpan, 'click', function(e) {
                        var activeTab = scriptBlock.activeTab;
                        labelElems[activeTab].className += otherTabClass;
                        pres[activeTab].className += hiddenPreClass;

                        codePre.className = codePre.className.replace(hiddenPreClass, '');
                        labelSpan.className = labelSpan.className.replace(otherTabClass, '');
                        scriptBlock.activeTab = index;
                    });
                });

                var preview = Galleries.findElem(scriptBlock, 'div', 'preview');
                if (preview.length == 0) {
                    preview.push(pres[pres.length - 1]);
                }
                Galleries.iterateElem(preview, function(index, elem) {
                    elem.parentNode.removeChild(elem);
                });

                if (window.clipboardData && clipboardData.setData) {
                    var copyLink = document.createElement('a');
                    copyLink.href = 'javascript:void(0);';
                    copyLink.className = 'copyCode';
                    copyLink.innerHTML = 'Copy Code';
                    Galleries.attachEventHandler(copyLink, 'click', function (e) {
                        clipboardData.setData("Text", htmlDecode(labelElems[scriptBlock.activeTab].code));
                        return false;
                    });
                    scriptBlock.insertBefore(copyLink, scriptBlock.childNodes[0]);
                }
            }
        });
    }

    Galleries.onWindowLoad(function(){
        initializePage();
    });

</script>
<div id="longDesc">
    
<h1><span style="font-size:large">Introduction</span></h1>
<p>A Visual Studio Package which provides a new tool window called &quot;Build Progress&quot; which displays a WPF ProgressBar indicating percentage completion of the current solution build.</p>
<h1><span style="font-size:large">Getting Started</span></h1>
<p>To build and run this sample, you must have Visual Studio 2010 installed, as well as the Visual Studio SDK. Unzip the BuildProgressBar.zip file into your Visual Studio Projects directory (My Documents\Visual Studio 2010\Projects) and open the BuildProgressBar.sln
 solution.</p>
<h1><span style="font-size:large">Building the Sample</span></h1>
<p>To build the sample, make sure the BuildProgressBar solution is open and then use the Build | Build Solution menu command.</p>
<h1><span style="font-size:large">Running the Sample</span></h1>
<p>To run the sample, hit F5 or choose the Debug | Start Debugging menu command. A new instance of Visual Studio will launch under the experimental hive. The experimental hive is a special &quot;sandbox&quot; instance of Visual Studio that allows you to develop and test
 packages without affecting your main instance of Visual Studio. Once loaded, choose the View | Other Windows | Build Progress menu command. A new tool window called &quot;Build Progress&quot; will open, displaying a WPF ProgressBar control. You can move, resize, or
 dock this tool window however you like. Next, either open an existing buildable solution or create a new one by using the File | New | Project menu command. Once the solution has loaded, build the solution by running the Build | Build Solution menu command.
 You should see the progress bar's value and text change as each project in the solution is built.</p>
<h1><span style="font-size:large">Source Code Overview</span></h1>
<p>The source code in this sample demonstrates several techniques you can use to write your own packages:</p>
<ul>
<li>How to add a menu command to the View | Other Windows menu group. </li><li>How to display WPF content on a tool window </li><li>How to monitor solution load/unload events </li><li>How to monitor solution build events </li><li>How to check and monitor the value of a Visual Studio Shell property (VisualEffectsAllowed)
</li></ul>
<p>Our Visual Studio Package implements the interfaces IVsShellPropertyEvents, IVsSolutionEvents, and IVsUpdateSolutionEvents2 so that it can receive notification of shell property changes, solution load/unload events, and solution build events. However, in
 order to receive calls to these interface methods, it must advise the appropriate service providers that we want to be notified, as demonstrated in the ProgressBarPackage's Initialize method.</p>
<p>We monitor the value of the VisualEffectsAllowed shell property in order to modify how the progress bar is displayed. We also monitor solution load/unload events to keep track of how many projects are currently loaded in the solution. Lastly, we monitor
 solution build events in order to update the value and text of the progress bar.</p>
<h1><span style="font-size:large">Project Files</span></h1>
<ul>
<li>BuildProgressBar.vsct - Defines layout and type of commands in the package, namely the Build Progress menu command.
</li><li>BuildProgressToolWindow.cs - Implements the tool window functionality, and owns an instance of the ProgressBarControl.
</li><li>ProgressBarControl.xaml - Defines the XAML for the ProgressBarControl, which is the content hosted on the tool window.
</li><li>ProgressBarControl.xaml.cs - Defines the code-behind for the ProgressBarControl. This gives us greater control over the behavior of the ProgressBarControl.
</li><li>ProgressBarPackage.cs - Implements the Visual Studio Package, where we monitor events.
</li></ul>

</div>


    </div>
</body>
</html>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head><link rel="stylesheet" type="text/css" href="description/Combined.css,0:sprite;/Areas/Epx/Themes/Windows/Content:0&amp;amp;hashKey=B5E5F4F4AE5278BDA2ADB3607072DA9C" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="description/dc96e5d0-205a-4f07-963c-0adecf31d9c1Combined.css,0:sprite,1:LinkList;/Areas/Epx/Themes/Windows/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;hashKey=3985696AFC623BD5CCF8BE823D027701" xmlns="http://www.w3.org/1999/xhtml" />

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>NDIS Virtual Miniport Driver</title>
        <link href="description/Galleries.css" type="text/css" rel="Stylesheet" /><link href="description/Layout.css" type="text/css" rel="Stylesheet" /><link href="description/Brand.css" type="text/css" rel="Stylesheet" /><link href="description/19eccd10-9a4c-4ebc-a240-2680a581332eBrand.css" type="text/css" rel="Stylesheet" />
        <link href="description/iframedescription.css" rel="Stylesheet" type="text/css" />
        <script src="description/offline.js" type="text/javascript"></script>
        <style type="text/css">
            #projectInfo {
                overflow: auto;
            }
            #longDesc {
                clear:both;
                margin: 25px 0 10px 0;
            }

            #SampleIndexList{
                margin-left: 15px;
            }
        </style>
    </head>
<body>
    <div id="offlineDescription">
        <h1>NDIS Virtual Miniport Driver</h1>
        <br/>
        <div id="projectInfo">
            <div class="section">
                    <div class="itemBarLong tagsContainer">
                        <label for="Technologies">Technologies</label>
                        <div id="Technologies">
                            ndis, Windows Driver
                        </div>
                    </div>
                    <div class="itemBarLong tagsContainer">
                        <label for="Topics">Topics</label>
                        <div id="Topics">
                            Networking
                        </div>
                    </div>
                <div class="itemBarLong">
                    <label for="Platforms">Platforms</label>
                    <div id="Platforms">
                        Desktop
                    </div>
                </div>
                <div class="itemBarLong">
                    <label for="Requirements">Requirements</label>
                    <div id="Requirements">
                        
                    </div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Primary language</label>
                    <div id="LastUpdated">en-US</div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Updated</label>
                    <div id="LastUpdated">4/2/2014</div>
                </div>
                <div class="itemBarLong">
                    <label for="License">License</label>
                    <div id="License">
                        <a href="license.rtf">MS-LPL</a></div>
                </div>
                <div class="itemBar">
                    <div class="viewonlinecont">
                        <a data-link="online" href="http://code.msdn.microsoft.com/windowshardware/NDIS-Virtual-Miniport-58d27f0f">View this sample online</a>
                    </div>
                </div>
            </div>
        </div>
        
                   
<script type="text/javascript">
    function initializePage() {
        var otherTabClass = 'otherTab';
        var hiddenPreClass = 'hidden';

        var htmlDecode = function(encodedData) {
            var decodedData = "";
            if (encodedData) {
                var div = document.createElement('div');
                div.innerHTML = encodedData;
                decodedData = div.firstChild.nodeValue.replace( /\\r\\n/ig , '\r\n');
            }
            return decodedData;
        };
                
        Galleries.iterateElem(Galleries.findElem(null, 'div', 'scriptcode'), function (index, scriptBlock) {
            var titleElem = Galleries.findElem(scriptBlock, 'div', 'title')[0];
            var labelElems = Galleries.findElem(titleElem, 'span');
            if (labelElems.length == 0) {
                labelElems = titleElem;
            }
            var languageSpans = Galleries.findElem(scriptBlock, 'span', 'hidden');
            var pres = Galleries.findElem(scriptBlock, 'pre');
            if (languageSpans.length > 0 && pres.length > 1) {
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    var languageSpan = languageSpans[index];
                            
                    elem.code = codePre.innerHTML.replace( /(\r(\n)?)|((\r)?\n)/ig , '\\r\\n');
                            
                    codePre.className = codePre.className.replace(hiddenPreClass, '');
                            
                    languageSpan.parentNode.removeChild(languageSpan);
                });

                pres = Galleries.findElem(scriptBlock, 'pre');
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    if (index == 0) {
                        scriptBlock.activeTab = 0;
                    }
                    else {
                        labelSpan.className += otherTabClass;
                        codePre.className += hiddenPreClass;
                    }
                    Galleries.attachEventHandler(labelSpan, 'click', function(e) {
                        var activeTab = scriptBlock.activeTab;
                        labelElems[activeTab].className += otherTabClass;
                        pres[activeTab].className += hiddenPreClass;

                        codePre.className = codePre.className.replace(hiddenPreClass, '');
                        labelSpan.className = labelSpan.className.replace(otherTabClass, '');
                        scriptBlock.activeTab = index;
                    });
                });

                var preview = Galleries.findElem(scriptBlock, 'div', 'preview');
                if (preview.length == 0) {
                    preview.push(pres[pres.length - 1]);
                }
                Galleries.iterateElem(preview, function(index, elem) {
                    elem.parentNode.removeChild(elem);
                });

                if (window.clipboardData && clipboardData.setData) {
                    var copyLink = document.createElement('a');
                    copyLink.href = 'javascript:void(0);';
                    copyLink.className = 'copyCode';
                    copyLink.innerHTML = 'Copy code';
                    Galleries.attachEventHandler(copyLink, 'click', function (e) {
                        clipboardData.setData("Text", htmlDecode(labelElems[scriptBlock.activeTab].code));
                        return false;
                    });
                    scriptBlock.insertBefore(copyLink, scriptBlock.childNodes[0]);
                }
            }
        });
    }

    Galleries.onWindowLoad(function(){
        initializePage();
    });

</script>
<div id="longDesc">
    
<div id="mainSection">
<p>The NDIS Virtual Miniport Driver sample illustrates the functionality of an NDIS miniport driver without requiring a physical network adapter.
</p>
<p>Because the driver does not interact with any hardware, it makes it easier to understand the miniport interface and the usage of various NDIS functions without the clutter of hardware-specific code that is normally found in a fully functional driver. The
 driver can be installed either manually using the Add Hardware wizard as a root enumerated virtual miniport driver or on a virtual bus (like toaster bus).
</p>
<p>This sample driver demonstrates an NDIS virtual miniport driver. If a single instance of the virtual miniport exists, it simply drops the send packets and completes the send operation successfully. If there are multiple virtual miniport instances, the instances
 behave as if they were multiple network interface cards (NICs) plugged into a single Ethernet hub. This &quot;hub&quot; indicates the incoming send packets to all of the virtual miniport instances.</p>
<p>To test the miniport driver, install more than one miniport driver instance. You can repeat the installation to install more than one instance of the miniport.</p>
<p class="note"><b>Note</b>&nbsp;&nbsp;This sample provides an example of minimal driver intended for education purposes. The driver and its sample test programs are not intended for use in a production environment.</p>
<p class="note"><b>Note</b>&nbsp;&nbsp;</p>
<p class="note">To build this sample, you can use Microsoft Visual Studio&nbsp;2013 (Express, Professional, or Ultimate) and Windows Driver Kit (WDK)&nbsp;8.1 Update. You can get Visual Studio&nbsp;2013 and WDK&nbsp;8.1 Update
<a href="http://go.microsoft.com/fwlink/p/?LInkID=239721">here</a>.</p>
<p class="note">You can also build this sample with Visual Studio&nbsp;2013 (Professional or Ultimate) and
<a href="http://go.microsoft.com/fwlink/p/?LInkID=391348">Windows Driver Kit (WDK)&nbsp;8.1</a>.</p>
<p class="note">For Windows Driver Kit (WDK)&nbsp;8 samples, download the <a href="http://code.msdn.microsoft.com/windowshardware/NDIS-Virtual-Miniport-58d27f0f/ http://go.microsoft.com/fwlink/?LinkId=317090">
WDK&nbsp;8 samples pack</a>. The samples in the WDK&nbsp;8 samples pack will build only with Microsoft Visual Studio Professional&nbsp;2012 (Professional or Ultimate) and WDK&nbsp;8.</p>
<p></p>
<h2>Operating system requirements</h2>
<table>
<tbody>
<tr>
<th>Client</th>
<td><dt>Windows&nbsp;7 </dt></td>
</tr>
<tr>
<th>Server</th>
<td><dt>Windows Server&nbsp;2008&nbsp;R2 </dt></td>
</tr>
</tbody>
</table>
<h2>Build the sample</h2>
<p>For information on how to build a driver solution using Microsoft Visual Studio, see
<a href="http://msdn.microsoft.com/en-us/library/windows/hardware/ff554644">Building a Driver</a>.</p>
<h2>Run the sample</h2>
<h2><a id="File_Manifest"></a><a id="file_manifest"></a><a id="FILE_MANIFEST"></a>File Manifest</h2>
<table>
<tbody>
<tr>
<th>File</th>
<th>Description</th>
</tr>
<tr>
<td>netVmini60.inf</td>
<td>INF file for installing the NDIS 6.0 version of the driver.</td>
</tr>
<tr>
<td>netVmini620.inf</td>
<td>INF file for installing the NDIS 6.20 version of the driver.</td>
</tr>
<tr>
<td>netVmini630.inf</td>
<td>INF file for installing the NDIS 6.30 version of the driver.</td>
</tr>
<tr>
<td>netVmini60.RC</td>
<td>Resource file for the NDIS 6.0 version of the driver.</td>
</tr>
<tr>
<td>netVmini620.RC</td>
<td>Resource file for the NDIS 6.20 version of the driver.</td>
</tr>
<tr>
<td>netVmini630.RC</td>
<td>Resource file for the NDIS 6.30 version of the driver.</td>
</tr>
<tr>
<td>adapter.c</td>
<td>Contains <a href="http://msdn.microsoft.com/en-us/library/windows/hardware/ff559389">
<i>MiniportInitializeEx</i></a> and other miniport adapter functions.</td>
</tr>
<tr>
<td>adapter.h</td>
<td>Include file for defining miniport adapter structures, constants, and function prototypes.</td>
</tr>
<tr>
<td>ctrlpath.c</td>
<td>Contains <a href="http://msdn.microsoft.com/en-us/library/windows/hardware/ff559416">
<i>MiniportOidRequest</i></a> and other OID-related functions.</td>
</tr>
<tr>
<td>ctrlpath.h</td>
<td>Include file for defining miniport OID-related structures, constants, and function prototypes.</td>
</tr>
<tr>
<td>datapath.c</td>
<td>Contains <a href="http://msdn.microsoft.com/en-us/library/windows/hardware/ff559440">
<i>MiniportSendNetBufferLists</i></a> and other data path-related functions.</td>
</tr>
<tr>
<td>datapath.h</td>
<td>Include file for defining miniport data path-related structures, constants, and function prototypes.</td>
</tr>
<tr>
<td>hardware.h</td>
<td>Include file for defining characteristics of the network adapter's virtual hardware.</td>
</tr>
<tr>
<td>miniport.c</td>
<td>Main file that contains <a href="http://msdn.microsoft.com/en-us/library/windows/hardware/ff548818">
<b>DriverEntry</b></a> and other miniport driver functions.</td>
</tr>
<tr>
<td>miniport.h</td>
<td>Include file for defining miniport driver structures, constants, and function prototypes.</td>
</tr>
<tr>
<td>mphal.c</td>
<td>Contains functions that implement the network adapter's virtual hardware.</td>
</tr>
<tr>
<td>mphal.h</td>
<td>Include file for defining structures, constants, and function prototypes that are used in mphal.c.</td>
</tr>
<tr>
<td>netvmin6.h</td>
<td>Master include file that lists all the header files needed to compile this sample driver.</td>
</tr>
<tr>
<td>qos.c</td>
<td>Contains functions that implement the network adapter's QOS functionality.</td>
</tr>
<tr>
<td>qos.h</td>
<td>Include file for defining structures, constants, and function prototypes that are used in qos.c.</td>
</tr>
<tr>
<td>tcbrcb.c</td>
<td>Contains functions that implement the miniport driver's send and receive code path.</td>
</tr>
<tr>
<td>tcbrcb.h</td>
<td>Include file for defining structures, constants, and function prototypes that are used in tcbrcb.c.</td>
</tr>
<tr>
<td>trace.h</td>
<td>Include file for defining debug support macros.</td>
</tr>
<tr>
<td>vmq.c</td>
<td>Contains functions that implement the network adapter's VMQ functionality.</td>
</tr>
<tr>
<td>vmq.h</td>
<td>Include file for defining structures, constants, and function prototypes that are used in vmq.c.</td>
</tr>
</tbody>
</table>
<p>For more information on creating NDIS Miniport Drivers, see <a href="http://msdn.microsoft.com/en-us/library/windows/hardware/ff565949">
NDIS Miniport Drivers</a>.</p>
</div>

</div>


    </div>
</body>
</html>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head><link rel="stylesheet" type="text/css" href="description/Combined.css,0:HeaderFooterSprite,0:Header.NonMtps,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;hashKey=C9973DA951AE6202C9B348379A1BE49D" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="description/0aac1760-b513-488a-ba57-e31d9413a075Combined.css,0:HeaderFooterSprite,0:Footer.NonMtps,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;hashKey=F576C687BC536B84D6E5B3246EE39B49" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>Lync 2010: Working With Presence and Groups in UCMA 3.0</title>
        <link href="description/Galleries.css" type="text/css" rel="Stylesheet" /><link href="description/Layout.css" type="text/css" rel="Stylesheet" /><link href="description/Brand.css" type="text/css" rel="Stylesheet" />
        <link href="description/iframedescription.css" rel="Stylesheet" type="text/css" />
        <script src="description/offline.js" type="text/javascript"></script>
        <style type="text/css">
            #projectInfo {
                overflow: auto;
            }
            #longDesc {
                clear:both;
                margin: 25px 0 10px 0;
            }

            #SampleIndexList{
                margin-left: 15px;
            }
        </style>
    </head>
<body>
    <div id="offlineDescription">
        <h1>Lync 2010: Working With Presence and Groups in UCMA 3.0</h1>
        <br/>
        <div id="projectInfo">
            <div class="section">
                    <div class="itemBarLong tagsContainer">
                        <label for="Technologies">Technologies</label>
                        <div id="Technologies">
                            Unified Communications Managed API (UCMA) 3.0, Microsoft Lync 2010
                        </div>
                    </div>
                    <div class="itemBarLong tagsContainer">
                        <label for="Topics">Topics</label>
                        <div id="Topics">
                            Contacts, Groups, Presence
                        </div>
                    </div>
                <div class="itemBarLong">
                    <label for="Platforms">Platforms</label>
                    <div id="Platforms">
                        Desktop
                    </div>
                </div>
                <div class="itemBarLong">
                    <label for="Requirements">Requirements</label>
                    <div id="Requirements">
                        
                    </div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Primary language</label>
                    <div id="LastUpdated">en-US</div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Updated</label>
                    <div id="LastUpdated">9/19/2011</div>
                </div>
                <div class="itemBarLong">
                    <label for="License">License</label>
                    <div id="License">
                        <a href="license.rtf">Apache License, Version 2.0</a></div>
                </div>
                <div class="itemBar">
                    <div class="viewonlinecont">
                        <a data-link="online" href="http://code.msdn.microsoft.com/Lync-2010-Working-With-be423675">View this sample online</a>
                    </div>
                </div>
            </div>
        </div>
        
                   
<script type="text/javascript">
    function initializePage() {
        var otherTabClass = 'otherTab';
        var hiddenPreClass = 'hidden';

        var htmlDecode = function(encodedData) {
            var decodedData = "";
            if (encodedData) {
                var div = document.createElement('div');
                div.innerHTML = encodedData;
                decodedData = div.firstChild.nodeValue.replace( /\\r\\n/ig , '\r\n');
            }
            return decodedData;
        };
                
        Galleries.iterateElem(Galleries.findElem(null, 'div', 'scriptcode'), function (index, scriptBlock) {
            var titleElem = Galleries.findElem(scriptBlock, 'div', 'title')[0];
            var labelElems = Galleries.findElem(titleElem, 'span');
            if (labelElems.length == 0) {
                labelElems = titleElem;
            }
            var languageSpans = Galleries.findElem(scriptBlock, 'span', 'hidden');
            var pres = Galleries.findElem(scriptBlock, 'pre');
            if (languageSpans.length > 0 && pres.length > 1) {
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    var languageSpan = languageSpans[index];
                            
                    elem.code = codePre.innerHTML.replace( /(\r(\n)?)|((\r)?\n)/ig , '\\r\\n');
                            
                    codePre.className = codePre.className.replace(hiddenPreClass, '');
                            
                    languageSpan.parentNode.removeChild(languageSpan);
                });

                pres = Galleries.findElem(scriptBlock, 'pre');
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    if (index == 0) {
                        scriptBlock.activeTab = 0;
                    }
                    else {
                        labelSpan.className += otherTabClass;
                        codePre.className += hiddenPreClass;
                    }
                    Galleries.attachEventHandler(labelSpan, 'click', function(e) {
                        var activeTab = scriptBlock.activeTab;
                        labelElems[activeTab].className += otherTabClass;
                        pres[activeTab].className += hiddenPreClass;

                        codePre.className = codePre.className.replace(hiddenPreClass, '');
                        labelSpan.className = labelSpan.className.replace(otherTabClass, '');
                        scriptBlock.activeTab = index;
                    });
                });

                var preview = Galleries.findElem(scriptBlock, 'div', 'preview');
                if (preview.length == 0) {
                    preview.push(pres[pres.length - 1]);
                }
                Galleries.iterateElem(preview, function(index, elem) {
                    elem.parentNode.removeChild(elem);
                });

                if (window.clipboardData && clipboardData.setData) {
                    var copyLink = document.createElement('a');
                    copyLink.href = 'javascript:void(0);';
                    copyLink.className = 'copyCode';
                    copyLink.innerHTML = 'Copy code';
                    Galleries.attachEventHandler(copyLink, 'click', function (e) {
                        clipboardData.setData("Text", htmlDecode(labelElems[scriptBlock.activeTab].code));
                        return false;
                    });
                    scriptBlock.insertBefore(copyLink, scriptBlock.childNodes[0]);
                }
            }
        });
    }

    Galleries.onWindowLoad(function(){
        initializePage();
    });

</script>
<div id="longDesc">
    
<h1>Introduction</h1>
<p><span style="font-size:small">Learn how to use presence to find an available member of a Microsoft Lync 2010 contact group, and then add the contact to a multiparty group conversation.</span></p>
<h1><span style="font-size:20px; font-weight:bold">Description</span></h1>
<p><span style="font-size:small">The fictitious Contoso Corporation deploys a UCMA 3.0 application that can be accessed by Lync 2010 users. The endpoint that represents this application has two contact groups, one for the Service Department and one for the
 Sales Department. Each of these contact groups lists the employees who are in that department.</span></p>
<p><span style="font-size:small"><em>Note: </em>The application as implemented in this article series requires two user-defined contact groups to be present in Lync 2010 on the computer that runs the application. Each of these groups must have at least one
 contact.</span></p>
<p><span style="font-size:small">A Lync 2010 user sends an instant message to the UCMA 3.0 application. The UCMA 3.0 application responds with a
</span><span style="font-size:small">simple text menu, requesting the Lync 2010 user to press 1 to be connected to someone in the Service Department, and to press 2 to be connected to someone in the Sales Department.</span></p>
<p><span style="font-size:small">Based on the user&rsquo;s choice, the UCMA 3.0 application checks either the Service Department contact group or the Sales
</span><span style="font-size:small">Department contact group. If a contact in the appropriate group is available, the UCMA 3.0 application escalates the existing conversation between itself and the Lync 2010 user to a conference (the Lync 2010 terminology,
 a group </span><span style="font-size:small">conversation), and then invites the contact to join the conference. After the contact accepts the conference invitation, the UCMA 3.0 application ends, and drops out of the conference. The two other parties remain
 in the conference, </span><span style="font-size:small">which is now a two-person group conversation.</span></p>
<p><span style="font-size:small">In the implementation that is described in this series of articles, the UCMA 3.0 application accepts only instant
</span><span style="font-size:small">message calls (instances of the <a href="http://msdn.microsoft.com/en-us/library/microsoft.rtc.collaboration.instantmessagingcall_di_3_uc_ocs14mreflyncuc3cr.aspx">
InstantMessagingCall</a> class). A different implementation might accept voice calls (instances of the
<a href="http://msdn.microsoft.com/en-us/library/microsoft.rtc.collaboration.audiovideo.audiovideocall_di_3_uc_ocs14mreflyncuc3cr.aspx">
AudioVideoCall</a> class), and then transfer the incoming call to the appropriate contact. Because
</span><span style="font-size:small">an <span class="label">InstantMessagingCall</span> instance cannot be transferred, the workaround as implemented in this series of articles is to escalate the two-way instant messaging conversation to a conference, and
 then invite into the conference the contact that was previously found.</span></p>
<p><span style="font-size:small">The most important tasks that the UCMA 3.0 application performs are the following.</span></p>
<ul>
<li>
<p><span style="font-size:small">Based on the user&rsquo;s choice, it finds an available person in a contact
</span><span style="font-size:small">group.</span></p>
</li><li>
<p><span style="font-size:small">Escalates the two-way conversation to a conference (a group conversation),
</span><span style="font-size:small">and invites the sales or service person into the conference.</span></p>
</li></ul>
<h1>More Information</h1>
<p><span style="font-size:small">For information about finding an available contact, see
<a href="http://msdn.microsoft.com/en-us/library/hh456404.aspx">Working With Presence and Groups in UCMA 3.0: Finding a Contact (Part 3 of 5)</a>. For information about escalating the conversation, see
<a href="http://msdn.microsoft.com/en-us/library/hh456408.aspx">Working With Presence and Groups in UCMA 3.0: Adding the Contact to the Conversation (Part 4 of 5)</a>.</span></p>

</div>


    </div>
</body>
</html>

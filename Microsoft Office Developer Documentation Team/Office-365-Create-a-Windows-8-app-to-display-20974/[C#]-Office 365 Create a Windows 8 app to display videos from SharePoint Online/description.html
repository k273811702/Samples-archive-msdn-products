<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head><link rel="stylesheet" type="text/css" href="description/Combined.css,0:HeaderFooterSprite,0:Header.NonMtps,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;hashKey=C9973DA951AE6202C9B348379A1BE49D" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="description/9e116645-9d9a-4566-82a8-7b29a5b324f1Combined.css,0:HeaderFooterSprite,0:Footer.NonMtps,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;hashKey=F576C687BC536B84D6E5B3246EE39B49" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>Office 365: Create a Windows 8 app to display videos from SharePoint Online</title>
        <link href="description/Galleries.css" type="text/css" rel="Stylesheet" /><link href="description/Layout.css" type="text/css" rel="Stylesheet" /><link href="description/Brand.css" type="text/css" rel="Stylesheet" />
        <link href="description/iframedescription.css" rel="Stylesheet" type="text/css" />
        <script src="description/offline.js" type="text/javascript"></script>
        <style type="text/css">
            #projectInfo {
                overflow: auto;
            }
            #longDesc {
                clear:both;
                margin: 25px 0 10px 0;
            }

            #SampleIndexList{
                margin-left: 15px;
            }
        </style>
    </head>
<body>
    <div id="offlineDescription">
        <h1>Office 365: Create a Windows 8 app to display videos from SharePoint Online</h1>
        <br/>
        <div id="projectInfo">
            <div class="section">
                    <div class="itemBarLong tagsContainer">
                        <label for="Technologies">Technologies</label>
                        <div id="Technologies">
                            Office 365
                        </div>
                    </div>
                    <div class="itemBarLong tagsContainer">
                        <label for="Topics">Topics</label>
                        <div id="Topics">
                            Authentication, cloud development, My Site
                        </div>
                    </div>
                <div class="itemBarLong">
                    <label for="Platforms">Platforms</label>
                    <div id="Platforms">
                        Cloud
                    </div>
                </div>
                <div class="itemBarLong">
                    <label for="Requirements">Requirements</label>
                    <div id="Requirements">
                        
                    </div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Primary language</label>
                    <div id="LastUpdated">en-US</div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Updated</label>
                    <div id="LastUpdated">2/27/2013</div>
                </div>
                <div class="itemBarLong">
                    <label for="License">License</label>
                    <div id="License">
                        <a href="license.rtf">Apache License, Version 2.0</a></div>
                </div>
                <div class="itemBar">
                    <div class="viewonlinecont">
                        <a data-link="online" href="http://code.msdn.microsoft.com/Office-365-Create-Windows-5a88ccfc">View this sample online</a>
                    </div>
                </div>
            </div>
        </div>
        
                   
<script type="text/javascript">
    function initializePage() {
        var otherTabClass = 'otherTab';
        var hiddenPreClass = 'hidden';

        var htmlDecode = function(encodedData) {
            var decodedData = "";
            if (encodedData) {
                var div = document.createElement('div');
                div.innerHTML = encodedData;
                decodedData = div.firstChild.nodeValue.replace( /\\r\\n/ig , '\r\n');
            }
            return decodedData;
        };
                
        Galleries.iterateElem(Galleries.findElem(null, 'div', 'scriptcode'), function (index, scriptBlock) {
            var titleElem = Galleries.findElem(scriptBlock, 'div', 'title')[0];
            var labelElems = Galleries.findElem(titleElem, 'span');
            if (labelElems.length == 0) {
                labelElems = titleElem;
            }
            var languageSpans = Galleries.findElem(scriptBlock, 'span', 'hidden');
            var pres = Galleries.findElem(scriptBlock, 'pre');
            if (languageSpans.length > 0 && pres.length > 1) {
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    var languageSpan = languageSpans[index];
                            
                    elem.code = codePre.innerHTML.replace( /(\r(\n)?)|((\r)?\n)/ig , '\\r\\n');
                            
                    codePre.className = codePre.className.replace(hiddenPreClass, '');
                            
                    languageSpan.parentNode.removeChild(languageSpan);
                });

                pres = Galleries.findElem(scriptBlock, 'pre');
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    if (index == 0) {
                        scriptBlock.activeTab = 0;
                    }
                    else {
                        labelSpan.className += otherTabClass;
                        codePre.className += hiddenPreClass;
                    }
                    Galleries.attachEventHandler(labelSpan, 'click', function(e) {
                        var activeTab = scriptBlock.activeTab;
                        labelElems[activeTab].className += otherTabClass;
                        pres[activeTab].className += hiddenPreClass;

                        codePre.className = codePre.className.replace(hiddenPreClass, '');
                        labelSpan.className = labelSpan.className.replace(otherTabClass, '');
                        scriptBlock.activeTab = index;
                    });
                });

                var preview = Galleries.findElem(scriptBlock, 'div', 'preview');
                if (preview.length == 0) {
                    preview.push(pres[pres.length - 1]);
                }
                Galleries.iterateElem(preview, function(index, elem) {
                    elem.parentNode.removeChild(elem);
                });

                if (window.clipboardData && clipboardData.setData) {
                    var copyLink = document.createElement('a');
                    copyLink.href = 'javascript:void(0);';
                    copyLink.className = 'copyCode';
                    copyLink.innerHTML = 'Copy code';
                    Galleries.attachEventHandler(copyLink, 'click', function (e) {
                        clipboardData.setData("Text", htmlDecode(labelElems[scriptBlock.activeTab].code));
                        return false;
                    });
                    scriptBlock.insertBefore(copyLink, scriptBlock.childNodes[0]);
                }
            }
        });
    }

    Galleries.onWindowLoad(function(){
        initializePage();
    });

</script>
<div id="longDesc">
    
<p id="header"><span class="label">Summary:</span> The solution in this sample demonstrates how to create a Windows 8 app that authenticates with a site in SharePoint Online, and then displays videos from a SharePoint asset library.</p>
<div id="mainSection">
<div id="mainBody">
<div class="introduction">
<div>&nbsp;</div>
</div>
<h1 class="heading">Description of the sample</h1>
<div class="section" id="sectionSection0">
<p>The main purpose of this sample is to demonstrate how a Windows 8 app authenticates with SharePoint Online in an Office 365 installation. The sample uses the username, password, and site URI entered on a browser to obtain a security token from the SharePoint
 security token service (STS). This token is then sent to SharePoint Online, and authorization cookies are sent back to the Windows 8 app.</p>
<p>A secondary purpose is to demonstrate how the app receives the appropriate authorization cookies, then includes them in calls to the REST services of SharePoint Online to read data from a SharePoint asset library. For this sample, the library contains video
 files, which are displayed back to the user in a selection list within the app.</p>
</div>
<h1 class="heading">Prerequisites</h1>
<div class="section" id="sectionSection1">
<div>This sample requires the following:</div>
<ul>
<li>
<div>An Office 365 Developer Site.</div>
</li><li>
<div>Visual Studio 2012 and Office Developer Tools for Visual Studio 2012 installed on your computer.</div>
</li></ul>
</div>
<h1 class="heading">Key components of the sample</h1>
<div class="section" id="sectionSection2">
<div>The sample zip file contains the following:</div>
<ul>
<li>
<div>A Visual Studio 2012 solution named O365_win8app_cs that contains the code for the Windows 8 app.</div>
</li></ul>
</div>
<h1 class="heading">Configure the sample</h1>
<div class="section" id="sectionSection3">
<ol>
<li>
<div>Open Visual Studio 2012 with administrator privileges.</div>
</li><li>
<div>On the <span class="ui">File</span> menu, click <span class="ui">Open</span>, click
<span class="ui">Project/Solution</span> and then navigate to the folder where you unzipped the O365_win8app_cs.sln file, select it and click
<span class="ui">Open</span>.</div>
</li></ol>
</div>
<h1 class="heading">Build the sample</h1>
<div class="section" id="sectionSection4">
<p>Press F6 to build the sample.</p>
</div>
<h1 class="heading">Run and test the sample</h1>
<div class="section" id="sectionSection5">
<ol>
<li>
<div>In an Office 365 Developer Site, create a SharePoint asset library. Upload one or more video files (.mp3, .mp4, or .wmv extensions only) to the library. Note the name of the site collection and the name of the asset library.</div>
</li><li>
<div>Press F5 to run the app. A login screen will be displayed to enter the following credentials:</div>
<ol>
<li>
<div>For <span class="ui">User Name</span> and <span class="ui">Password</span>, enter your Office 365 user name and password.</div>
</li><li>
<div>For <span class="ui">SharePoint Site Url</span>, enter the site collection name where the video asset library was created.</div>
</li><li>
<div>For <span class="ui">Library Name</span>, enter the name of the asset library which you created to store videos.</div>
</li></ol>
<div><img id="76632" src="description/O365_Win8AppDispVideosEntryScreen.jpg" alt="Win8App_To_Display_Videos_Entry_Screen" width="532" height="436"></div>
<div>&nbsp;</div>
</li><li>
<div>Click the <span class="ui">Login</span> button to authenticate by using your Office 365 credentials; if valid, the next page displays a list of video files in the asset library.</div>
<div><img id="76633" src="description/O365_Win8AppDispVideosDisplayScreen.jpg" alt="O365_Win8App_To_Display_Videos_Display_Screen" width="513" height="359"></div>
</li><li>
<div>Click any video link to navigate to the video player page, on which the app will begin playing the selected video.</div>
</li></ol>
</div>
<h1 class="heading">Troubleshooting</h1>
<div class="section" id="sectionSection6">
<p>The following table lists common configuration and environment errors that prevent the sample from running or deploying properly, and how you can solve them.</p>
<div class="caption"></div>
<div class="tableSection">
<table cellspacing="2" cellpadding="5" width="50%" frame="lhs">
<tbody>
<tr>
<th>
<div>Problem</div>
</th>
<th>
<div>Solution</div>
</th>
</tr>
<tr>
<td>
<div>Message displayed on bottom of login screen: &quot;Your credentials did not work or the service is down. Please try again.&quot;</div>
</td>
<td>
<div>Make sure that the username and password are correct. It may be useful to use a tool to debug the HTTP GET and POST requests and responses to SharePoint Online Services.</div>
</td>
</tr>
<tr>
<td>
<div>Message displayed on bottom of login screen: &quot;This App can't be activated using the Built-in administrator&quot;.</div>
</td>
<td>
<div>Make sure that the username is not an Administrator account; Windows 8 apps cannot run under a full administrator token. Windows 8 apps require that the User Account Control (UAC) be enabled and functioning; the Built-in Administrator account bypasses
 the UAC, so apps cannot be opened under that account.</div>
</td>
</tr>
<tr>
<td>
<div>Screen is shown, but no videos are listed.</div>
</td>
<td>
<div>Make sure that the URL entered on the login screen is the name of the site collection where the video asset library was created.</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<h1 class="heading">Change log</h1>
<div class="section" id="sectionSection7">
<div class="caption"></div>
<div class="tableSection">
<table cellspacing="2" cellpadding="5" width="50%" frame="lhs">
<tbody>
<tr>
<th>
<div>Version</div>
</th>
<th>
<div>Date</div>
</th>
</tr>
<tr>
<td>
<div>First version</div>
</td>
<td>
<div>February 28, 2013</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<h1 class="heading">Related content</h1>
<div class="section" id="sectionSection8">
<ul>
<li>
<div><a href="http://blogs.msdn.com/b/omarv/archive/2012/10/25/windows-8-store-apps-office-365-enterprise-preview-sharepoint-online.aspx" >Windows 8 Store Apps &#43; new Office 365 Enterprise Preview (SharePoint Online)</a></div>
</li><li>
<div><a href="http://msdn.microsoft.com/en-us/library/fp142385(v=office.15).aspx" >Programming using the SharePoint 2013 REST service</a></div>
</li><li>
<div><a href="http://msdn.microsoft.com/en-us/library/windows/apps/br229583.aspx" >Roadmap for Windows Store apps using C# or Visual Basic (Windows)</a></div>
</li></ul>
</div>
</div>
</div>
<p>&nbsp;</p>

</div>


    </div>
</body>
</html>

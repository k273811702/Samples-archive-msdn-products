<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head><link rel="stylesheet" type="text/css" href="description/Combined.css,0:HeaderFooterSprite,0:Header.NonMtps,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;hashKey=C9973DA951AE6202C9B348379A1BE49D" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="description/9e116645-9d9a-4566-82a8-7b29a5b324f1Combined.css,0:HeaderFooterSprite,0:Footer.NonMtps,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;hashKey=F576C687BC536B84D6E5B3246EE39B49" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>PowerPoint 2010: Working with Embedded Media</title>
        <link href="description/Galleries.css" type="text/css" rel="Stylesheet" /><link href="description/Layout.css" type="text/css" rel="Stylesheet" /><link href="description/Brand.css" type="text/css" rel="Stylesheet" />
        <link href="description/iframedescription.css" rel="Stylesheet" type="text/css" />
        <script src="description/offline.js" type="text/javascript"></script>
        <style type="text/css">
            #projectInfo {
                overflow: auto;
            }
            #longDesc {
                clear:both;
                margin: 25px 0 10px 0;
            }

            #SampleIndexList{
                margin-left: 15px;
            }
        </style>
    </head>
<body>
    <div id="offlineDescription">
        <h1>PowerPoint 2010: Working with Embedded Media</h1>
        <br/>
        <div id="projectInfo">
            <div class="section">
                    <div class="itemBarLong tagsContainer">
                        <label for="Technologies">Technologies</label>
                        <div id="Technologies">
                            PowerPoint 2010, Office 2010
                        </div>
                    </div>
                    <div class="itemBarLong tagsContainer">
                        <label for="Topics">Topics</label>
                        <div id="Topics">
                            embedding media
                        </div>
                    </div>
                <div class="itemBarLong">
                    <label for="Platforms">Platforms</label>
                    <div id="Platforms">
                        Desktop
                    </div>
                </div>
                <div class="itemBarLong">
                    <label for="Requirements">Requirements</label>
                    <div id="Requirements">
                        
                    </div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Primary language</label>
                    <div id="LastUpdated">en-US</div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Updated</label>
                    <div id="LastUpdated">8/3/2011</div>
                </div>
                <div class="itemBarLong">
                    <label for="License">License</label>
                    <div id="License">
                        <a href="license.rtf">Apache License, Version 2.0</a></div>
                </div>
                <div class="itemBar">
                    <div class="viewonlinecont">
                        <a data-link="online" href="http://code.msdn.microsoft.com/PowerPoint-2010-Working-d63a5ea7">View this sample online</a>
                    </div>
                </div>
            </div>
        </div>
        
                   
<script type="text/javascript">
    function initializePage() {
        var otherTabClass = 'otherTab';
        var hiddenPreClass = 'hidden';

        var htmlDecode = function(encodedData) {
            var decodedData = "";
            if (encodedData) {
                var div = document.createElement('div');
                div.innerHTML = encodedData;
                decodedData = div.firstChild.nodeValue.replace( /\\r\\n/ig , '\r\n');
            }
            return decodedData;
        };
                
        Galleries.iterateElem(Galleries.findElem(null, 'div', 'scriptcode'), function (index, scriptBlock) {
            var titleElem = Galleries.findElem(scriptBlock, 'div', 'title')[0];
            var labelElems = Galleries.findElem(titleElem, 'span');
            if (labelElems.length == 0) {
                labelElems = titleElem;
            }
            var languageSpans = Galleries.findElem(scriptBlock, 'span', 'hidden');
            var pres = Galleries.findElem(scriptBlock, 'pre');
            if (languageSpans.length > 0 && pres.length > 1) {
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    var languageSpan = languageSpans[index];
                            
                    elem.code = codePre.innerHTML.replace( /(\r(\n)?)|((\r)?\n)/ig , '\\r\\n');
                            
                    codePre.className = codePre.className.replace(hiddenPreClass, '');
                            
                    languageSpan.parentNode.removeChild(languageSpan);
                });

                pres = Galleries.findElem(scriptBlock, 'pre');
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    if (index == 0) {
                        scriptBlock.activeTab = 0;
                    }
                    else {
                        labelSpan.className += otherTabClass;
                        codePre.className += hiddenPreClass;
                    }
                    Galleries.attachEventHandler(labelSpan, 'click', function(e) {
                        var activeTab = scriptBlock.activeTab;
                        labelElems[activeTab].className += otherTabClass;
                        pres[activeTab].className += hiddenPreClass;

                        codePre.className = codePre.className.replace(hiddenPreClass, '');
                        labelSpan.className = labelSpan.className.replace(otherTabClass, '');
                        scriptBlock.activeTab = index;
                    });
                });

                var preview = Galleries.findElem(scriptBlock, 'div', 'preview');
                if (preview.length == 0) {
                    preview.push(pres[pres.length - 1]);
                }
                Galleries.iterateElem(preview, function(index, elem) {
                    elem.parentNode.removeChild(elem);
                });

                if (window.clipboardData && clipboardData.setData) {
                    var copyLink = document.createElement('a');
                    copyLink.href = 'javascript:void(0);';
                    copyLink.className = 'copyCode';
                    copyLink.innerHTML = 'Copy code';
                    Galleries.attachEventHandler(copyLink, 'click', function (e) {
                        clipboardData.setData("Text", htmlDecode(labelElems[scriptBlock.activeTab].code));
                        return false;
                    });
                    scriptBlock.insertBefore(copyLink, scriptBlock.childNodes[0]);
                }
            }
        });
    }

    Galleries.onWindowLoad(function(){
        initializePage();
    });

</script>
<div id="longDesc">
    
<h2><strong>Introduction</strong></h2>
<p>Learn how to programmatically embed media files into a Microsoft PowerPoint 2010 presentation. This sample accompanies the article
<a href="http://msdn.microsoft.com/en-us/library/ff601857.aspx">Working with Embedded Media in PowerPoint 2010</a> in the MSDN Library.</p>
<h2><strong>Description</strong></h2>
<p>By using Microsoft PowerPoint 2010, you can effectively engage your audience by embedding and customizing videos within your presentation. This sample shows how to use the PowerPoint 2010 Primary Interop Assembly (PIA) to programmatically create a new PowerPoint
 2010 presentation, add a new slide to the presentation, embed a video into the new slide, and format how the video will be displayed.</p>
<p>The following excerpt from the code sample shows how to use the PowerPoint 2010 PIA to embed a video into a slide and format how it will be displayed. The code embeds the video by using the
<a href="http://msdn.microsoft.com/en-us/library/microsoft.office.interop.powerpoint.shapes.addmediaobject2.aspx">
AddMediaObject2</a> method. The <em>FileName</em> parameter is the name of the video file to embed. The
<em>LinkToFile</em> parameter is set to <strong>false</strong>, and the <em>SaveWithDocument</em> parameter is set to
<strong>true</strong> to embed the file within the presentation. The <em>Left</em> and
<em>Top</em> parameters are used to define the location of the upper-left corner for the video display area. Named arguments are used because all of the parameters are not passed to the
<strong>AddMediaObject2</strong> method. For more information about named arguments, see
<a href="http://msdn.microsoft.com/en-us/library/dd264739.aspx">Named and Optional Arguments</a>.</p>
<p>The video file is then reset to its original size by calling the <a href="http://msdn.microsoft.com/en-us/library/microsoft.office.interop.powerpoint.shape.scaleheight.aspx">
ScaleHeight</a> and <a href="http://msdn.microsoft.com/en-us/library/microsoft.office.interop.powerpoint.shape.scalewidth.aspx">
ScaleWidth</a> methods. The first parameter is the factor to use when resizing, and the second parameter defines that resizing should be based on the original size.</p>
<p>The video file is then formatted to be displayed with a beveled edge by using the
<a href="http://msdn.microsoft.com/en-us/library/microsoft.office.interop.powerpoint.shape.threed.aspx">
ThreeD</a>.<a href="http://msdn.microsoft.com/en-us/library/microsoft.office.interop.powerpoint.threedformat.beveltopdepth.aspx">BevelTopDepth</a>,
<a href="http://msdn.microsoft.com/en-us/library/microsoft.office.interop.powerpoint.threedformat.beveltopinset.aspx">
BevelTopInset</a>, and <a href="http://msdn.microsoft.com/en-us/library/microsoft.office.interop.powerpoint.threedformat.bevelbottomtype.aspx">
BevelBottomType</a> properties. The video file is also formatted to display in a rounded rectangle shape by setting the
<a href="http://msdn.microsoft.com/en-us/library/microsoft.office.interop.powerpoint.shape.autoshapetype.aspx">
AutoShapeType</a> property to the <strong>msoAutoShapeType.msoShapeRoundedRectangle</strong> value.</p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>C#</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">csharp</span>
<pre class="hidden">// Embed the video file into the slide.
mediaFile = slide.Shapes.AddMediaObject2(
    FileName: mediaFileName,
    LinkToFile: MsoTriState.msoFalse,
    SaveWithDocument: MsoTriState.msoCTrue,
    Left: 90f,
    Top: 114f);

// Resize the video to its original size.
mediaFile.ScaleHeight(1f, MsoTriState.msoCTrue);
mediaFile.ScaleWidth(1f, MsoTriState.msoCTrue);

// Format to have a beveled edge.
mediaFile.ThreeD.BevelTopDepth = 8;
mediaFile.ThreeD.BevelTopInset = 6;
mediaFile.ThreeD.BevelBottomType = 
    MsoBevelType.msoBevelSoftRound;

// Format to display in a rounded rectangle shape.
mediaFile.AutoShapeType = 
    MsoAutoShapeType.msoShapeRoundedRectangle;
</pre>
<div class="preview">
<pre class="csharp"><span class="cs__com">//&nbsp;Embed&nbsp;the&nbsp;video&nbsp;file&nbsp;into&nbsp;the&nbsp;slide.</span>&nbsp;
mediaFile&nbsp;=&nbsp;slide.Shapes.AddMediaObject2(&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;FileName:&nbsp;mediaFileName,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;LinkToFile:&nbsp;MsoTriState.msoFalse,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;SaveWithDocument:&nbsp;MsoTriState.msoCTrue,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;Left:&nbsp;90f,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;Top:&nbsp;114f);&nbsp;
&nbsp;
<span class="cs__com">//&nbsp;Resize&nbsp;the&nbsp;video&nbsp;to&nbsp;its&nbsp;original&nbsp;size.</span>&nbsp;
mediaFile.ScaleHeight(1f,&nbsp;MsoTriState.msoCTrue);&nbsp;
mediaFile.ScaleWidth(1f,&nbsp;MsoTriState.msoCTrue);&nbsp;
&nbsp;
<span class="cs__com">//&nbsp;Format&nbsp;to&nbsp;have&nbsp;a&nbsp;beveled&nbsp;edge.</span>&nbsp;
mediaFile.ThreeD.BevelTopDepth&nbsp;=&nbsp;<span class="cs__number">8</span>;&nbsp;
mediaFile.ThreeD.BevelTopInset&nbsp;=&nbsp;<span class="cs__number">6</span>;&nbsp;
mediaFile.ThreeD.BevelBottomType&nbsp;=&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;MsoBevelType.msoBevelSoftRound;&nbsp;
&nbsp;
<span class="cs__com">//&nbsp;Format&nbsp;to&nbsp;display&nbsp;in&nbsp;a&nbsp;rounded&nbsp;rectangle&nbsp;shape.</span>&nbsp;
mediaFile.AutoShapeType&nbsp;=&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;MsoAutoShapeType.msoShapeRoundedRectangle;&nbsp;
</pre>
</div>
</div>
</div>
<div class="endscriptcode">&nbsp;</div>
<p>There are two attachments to this description:</p>
<ul>
<li><a id="25932" href="http://code.msdn.microsoft.com/site/view/file/25932/1/Butterfly.wmv">Butterfly.wmv</a>&mdash;A video file that you can use with this sample.
</li><li>
<p><a id="25934" href="http://code.msdn.microsoft.com/site/view/file/25934/1/PP2010EmbeddedVideo.pptx">PP2010EmbeddedVideo.pptx</a>&mdash;A sample PowerPoint presentation that contains the embedded video.</p>
</li></ul>

</div>


    </div>
</body>
</html>

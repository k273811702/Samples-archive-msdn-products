<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head><link rel="stylesheet" type="text/css" href="description/Combined.css,0:HeaderFooterSprite,0:Header.NonMtps,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;hashKey=C9973DA951AE6202C9B348379A1BE49D" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="description/a7bd86db-8a7a-43ce-8954-21f8f839f51bCombined.css,0:HeaderFooterSprite,0:Footer.NonMtps,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;hashKey=F576C687BC536B84D6E5B3246EE39B49" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>Excel 2010: Programming with Sparklines</title>
        <link href="description/Galleries.css" type="text/css" rel="Stylesheet" /><link href="description/Layout.css" type="text/css" rel="Stylesheet" /><link href="description/Brand.css" type="text/css" rel="Stylesheet" />
        <link href="description/iframedescription.css" rel="Stylesheet" type="text/css" />
        <script src="description/offline.js" type="text/javascript"></script>
        <style type="text/css">
            #projectInfo {
                overflow: auto;
            }
            #longDesc {
                clear:both;
                margin: 25px 0 10px 0;
            }

            #SampleIndexList{
                margin-left: 15px;
            }
        </style>
    </head>
<body>
    <div id="offlineDescription">
        <h1>Excel 2010: Programming with Sparklines</h1>
        <br/>
        <div id="projectInfo">
            <div class="section">
                    <div class="itemBarLong tagsContainer">
                        <label for="Technologies">Technologies</label>
                        <div id="Technologies">
                            Excel 2010, Office 2010
                        </div>
                    </div>
                    <div class="itemBarLong tagsContainer">
                        <label for="Topics">Topics</label>
                        <div id="Topics">
                            Sparklines
                        </div>
                    </div>
                <div class="itemBarLong">
                    <label for="Platforms">Platforms</label>
                    <div id="Platforms">
                        Desktop
                    </div>
                </div>
                <div class="itemBarLong">
                    <label for="Requirements">Requirements</label>
                    <div id="Requirements">
                        
                    </div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Primary language</label>
                    <div id="LastUpdated">en-US</div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Updated</label>
                    <div id="LastUpdated">8/12/2011</div>
                </div>
                <div class="itemBarLong">
                    <label for="License">License</label>
                    <div id="License">
                        <a href="license.rtf">Apache License, Version 2.0</a></div>
                </div>
                <div class="itemBar">
                    <div class="viewonlinecont">
                        <a data-link="online" href="http://code.msdn.microsoft.com/Excel-2010-Programming-45837a56">View this sample online</a>
                    </div>
                </div>
            </div>
        </div>
        
                   
<script type="text/javascript">
    function initializePage() {
        var otherTabClass = 'otherTab';
        var hiddenPreClass = 'hidden';

        var htmlDecode = function(encodedData) {
            var decodedData = "";
            if (encodedData) {
                var div = document.createElement('div');
                div.innerHTML = encodedData;
                decodedData = div.firstChild.nodeValue.replace( /\\r\\n/ig , '\r\n');
            }
            return decodedData;
        };
                
        Galleries.iterateElem(Galleries.findElem(null, 'div', 'scriptcode'), function (index, scriptBlock) {
            var titleElem = Galleries.findElem(scriptBlock, 'div', 'title')[0];
            var labelElems = Galleries.findElem(titleElem, 'span');
            if (labelElems.length == 0) {
                labelElems = titleElem;
            }
            var languageSpans = Galleries.findElem(scriptBlock, 'span', 'hidden');
            var pres = Galleries.findElem(scriptBlock, 'pre');
            if (languageSpans.length > 0 && pres.length > 1) {
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    var languageSpan = languageSpans[index];
                            
                    elem.code = codePre.innerHTML.replace( /(\r(\n)?)|((\r)?\n)/ig , '\\r\\n');
                            
                    codePre.className = codePre.className.replace(hiddenPreClass, '');
                            
                    languageSpan.parentNode.removeChild(languageSpan);
                });

                pres = Galleries.findElem(scriptBlock, 'pre');
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    if (index == 0) {
                        scriptBlock.activeTab = 0;
                    }
                    else {
                        labelSpan.className += otherTabClass;
                        codePre.className += hiddenPreClass;
                    }
                    Galleries.attachEventHandler(labelSpan, 'click', function(e) {
                        var activeTab = scriptBlock.activeTab;
                        labelElems[activeTab].className += otherTabClass;
                        pres[activeTab].className += hiddenPreClass;

                        codePre.className = codePre.className.replace(hiddenPreClass, '');
                        labelSpan.className = labelSpan.className.replace(otherTabClass, '');
                        scriptBlock.activeTab = index;
                    });
                });

                var preview = Galleries.findElem(scriptBlock, 'div', 'preview');
                if (preview.length == 0) {
                    preview.push(pres[pres.length - 1]);
                }
                Galleries.iterateElem(preview, function(index, elem) {
                    elem.parentNode.removeChild(elem);
                });

                if (window.clipboardData && clipboardData.setData) {
                    var copyLink = document.createElement('a');
                    copyLink.href = 'javascript:void(0);';
                    copyLink.className = 'copyCode';
                    copyLink.innerHTML = 'Copy code';
                    Galleries.attachEventHandler(copyLink, 'click', function (e) {
                        clipboardData.setData("Text", htmlDecode(labelElems[scriptBlock.activeTab].code));
                        return false;
                    });
                    scriptBlock.insertBefore(copyLink, scriptBlock.childNodes[0]);
                }
            }
        });
    }

    Galleries.onWindowLoad(function(){
        initializePage();
    });

</script>
<div id="longDesc">
    
<h2><strong>Introduction</strong></h2>
<p>Learn how to programmatically add Sparklines to a Microsoft Excel 2010 worksheet. This sample accompanies the article
<a href="http://msdn.microsoft.com/en-us/library/ff521866.aspx">Programming with Sparklines in Excel 2010</a> in the MSDN Library.</p>
<h2><strong>Description</strong></h2>
<p>Microsoft Excel 2010 introduces Sparklines, which enable you can create small charts in a single cell to quickly discover patterns in your data. It is a quick way to highlight important data trends such as seasonal increases or decreases.</p>
<p>This sample code shows how to use the Excel 2010 primary interop assembly to create a worksheet, add sales data, and add Sparklines to show trends in the sales data.</p>
<p>The following code example shows how to use the Excel 2010 primary interop assembly to add a Sparkline to a cell by using the
<strong>Range.SparklineGroups.Add</strong> method. The first parameter uses the <strong>
XlSparkType.xlSparkLine</strong> value to create a Line Sparkline; other kinds of Sparklines include Column and Win/Loss. The second parameter defines the range of cells that contain the data for the Sparkline.</p>
<p>The Sparkline is then formatted. The color is set by using the <strong>SparklineGroup.SeriesColor.ThemeColor</strong> property. The
<strong>SparklineGroup.Points.Highpoint.Visible</strong> property and the <strong>
SparklineGroup.Points.Lowpoint.Visible</strong> property are set to <strong>true</strong> to highlight the High data points and Low data points in the Sparkline. Other data points that could be highlighted include the First, Last, and Negative data points.
 It is also possible to display a marker for all data points on a Line Sparkline.</p>
<p>After the initial Sparkline is created and formatted, use the <strong>Range.Copy</strong> method to copy the Sparkline to the end of the remaining rows.</p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>C#</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">csharp</span>
<pre class="hidden">// Add a Sparkline to the cell at the end of the first row.
sparklineLocation = sheet.get_Range(&quot;F2&quot;);
sparkline = sparklineLocation.SparklineGroups.Add(
  XlSparkType.xlSparkLine, &quot;B2:E2&quot;);

// Format the Sparkline by defining a color theme.
sparkline.SeriesColor.ThemeColor = 5;

// Display a mark for the high and low data point.
sparkline.Points.Highpoint.Visible = true;
sparkline.Points.Lowpoint.Visible = true;

// Copy the Sparkline to the end of the remaining rows.
sparklineLocation.Copy(sheet.get_Range(&quot;F3:F6&quot;));
// Add a Sparkline to the cell at the end of the first row. 
sparklineLocation = sheet.get_Range(&quot;F2&quot;); 
sparkline = sparklineLocation.SparklineGroups.Add( 
  XlSparkType.xlSparkLine, &quot;B2:E2&quot;); 
 
// Format the Sparkline by defining a color theme. 
sparkline.SeriesColor.ThemeColor = 5; 
 
// Display a mark for the high and low data point. 
sparkline.Points.Highpoint.Visible = true; 
sparkline.Points.Lowpoint.Visible = true; 
 
// Copy the Sparkline to the end of the remaining rows. 
sparklineLocation.Copy(sheet.get_Range(&quot;F3:F6&quot;));</pre>
<div class="preview">
<pre class="csharp"><span class="cs__com">//&nbsp;Add&nbsp;a&nbsp;Sparkline&nbsp;to&nbsp;the&nbsp;cell&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;first&nbsp;row.</span>&nbsp;
sparklineLocation&nbsp;=&nbsp;sheet.get_Range(<span class="cs__string">&quot;F2&quot;</span>);&nbsp;
sparkline&nbsp;=&nbsp;sparklineLocation.SparklineGroups.Add(&nbsp;
&nbsp;&nbsp;XlSparkType.xlSparkLine,&nbsp;<span class="cs__string">&quot;B2:E2&quot;</span>);&nbsp;
&nbsp;
<span class="cs__com">//&nbsp;Format&nbsp;the&nbsp;Sparkline&nbsp;by&nbsp;defining&nbsp;a&nbsp;color&nbsp;theme.</span>&nbsp;
sparkline.SeriesColor.ThemeColor&nbsp;=&nbsp;<span class="cs__number">5</span>;&nbsp;
&nbsp;
<span class="cs__com">//&nbsp;Display&nbsp;a&nbsp;mark&nbsp;for&nbsp;the&nbsp;high&nbsp;and&nbsp;low&nbsp;data&nbsp;point.</span>&nbsp;
sparkline.Points.Highpoint.Visible&nbsp;=&nbsp;<span class="cs__keyword">true</span>;&nbsp;
sparkline.Points.Lowpoint.Visible&nbsp;=&nbsp;<span class="cs__keyword">true</span>;&nbsp;
&nbsp;
<span class="cs__com">//&nbsp;Copy&nbsp;the&nbsp;Sparkline&nbsp;to&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;remaining&nbsp;rows.</span>&nbsp;
sparklineLocation.Copy(sheet.get_Range(<span class="cs__string">&quot;F3:F6&quot;</span>));&nbsp;
<span class="cs__com">//&nbsp;Add&nbsp;a&nbsp;Sparkline&nbsp;to&nbsp;the&nbsp;cell&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;first&nbsp;row.&nbsp;</span>&nbsp;
sparklineLocation&nbsp;=&nbsp;sheet.get_Range(<span class="cs__string">&quot;F2&quot;</span>);&nbsp;&nbsp;
sparkline&nbsp;=&nbsp;sparklineLocation.SparklineGroups.Add(&nbsp;&nbsp;
&nbsp;&nbsp;XlSparkType.xlSparkLine,&nbsp;<span class="cs__string">&quot;B2:E2&quot;</span>);&nbsp;&nbsp;
&nbsp;&nbsp;
<span class="cs__com">//&nbsp;Format&nbsp;the&nbsp;Sparkline&nbsp;by&nbsp;defining&nbsp;a&nbsp;color&nbsp;theme.&nbsp;</span>&nbsp;
sparkline.SeriesColor.ThemeColor&nbsp;=&nbsp;<span class="cs__number">5</span>;&nbsp;&nbsp;
&nbsp;&nbsp;
<span class="cs__com">//&nbsp;Display&nbsp;a&nbsp;mark&nbsp;for&nbsp;the&nbsp;high&nbsp;and&nbsp;low&nbsp;data&nbsp;point.&nbsp;</span>&nbsp;
sparkline.Points.Highpoint.Visible&nbsp;=&nbsp;<span class="cs__keyword">true</span>;&nbsp;&nbsp;
sparkline.Points.Lowpoint.Visible&nbsp;=&nbsp;<span class="cs__keyword">true</span>;&nbsp;&nbsp;
&nbsp;&nbsp;
<span class="cs__com">//&nbsp;Copy&nbsp;the&nbsp;Sparkline&nbsp;to&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;remaining&nbsp;rows.&nbsp;</span>&nbsp;
sparklineLocation.Copy(sheet.get_Range(<span class="cs__string">&quot;F3:F6&quot;</span>));</pre>
</div>
</div>
</div>
<div class="endscriptcode">The sample code creates a workbook named Excel2010Sparklines.xlsx in the C:\Temp folder. (A sample
<a href="http://code.msdn.microsoft.com/Excel-2010-Programming-45837a56/file/41297/1/Excel2010Sparklines.xlsx">
Excel2010Sparklines.xlsx</a> workbook is attached to this description.) The code then adds trending data and a Sparkline to each row to show the sales trend.</div>

</div>


    </div>
</body>
</html>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head><link rel="stylesheet" type="text/css" href="description/Combined.css,0:HeaderFooterSprite,0:Header.NonMtps,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;hashKey=C9973DA951AE6202C9B348379A1BE49D" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="description/9e116645-9d9a-4566-82a8-7b29a5b324f1Combined.css,0:HeaderFooterSprite,0:Footer.NonMtps,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;hashKey=F576C687BC536B84D6E5B3246EE39B49" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>Office 365: Search for people on Lync and start conversations</title>
        <link href="description/Galleries.css" type="text/css" rel="Stylesheet" /><link href="description/Layout.css" type="text/css" rel="Stylesheet" /><link href="description/Brand.css" type="text/css" rel="Stylesheet" />
        <link href="description/iframedescription.css" rel="Stylesheet" type="text/css" />
        <script src="description/offline.js" type="text/javascript"></script>
        <style type="text/css">
            #projectInfo {
                overflow: auto;
            }
            #longDesc {
                clear:both;
                margin: 25px 0 10px 0;
            }

            #SampleIndexList{
                margin-left: 15px;
            }
        </style>
    </head>
<body>
    <div id="offlineDescription">
        <h1>Office 365: Search for people on Lync and start conversations</h1>
        <br/>
        <div id="projectInfo">
            <div class="section">
                    <div class="itemBarLong tagsContainer">
                        <label for="Technologies">Technologies</label>
                        <div id="Technologies">
                            Office 365, Lync
                        </div>
                    </div>
                    <div class="itemBarLong tagsContainer">
                        <label for="Topics">Topics</label>
                        <div id="Topics">
                            Search, Contacts, collaboration
                        </div>
                    </div>
                <div class="itemBarLong">
                    <label for="Platforms">Platforms</label>
                    <div id="Platforms">
                        Cloud
                    </div>
                </div>
                <div class="itemBarLong">
                    <label for="Requirements">Requirements</label>
                    <div id="Requirements">
                        
                    </div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Primary language</label>
                    <div id="LastUpdated">en-US</div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Updated</label>
                    <div id="LastUpdated">2/28/2013</div>
                </div>
                <div class="itemBarLong">
                    <label for="License">License</label>
                    <div id="License">
                        <a href="license.rtf">Apache License, Version 2.0</a></div>
                </div>
                <div class="itemBar">
                    <div class="viewonlinecont">
                        <a data-link="online" href="http://code.msdn.microsoft.com/Office-365-Search-for-c6e1b24c">View this sample online</a>
                    </div>
                </div>
            </div>
        </div>
        
                   
<script type="text/javascript">
    function initializePage() {
        var otherTabClass = 'otherTab';
        var hiddenPreClass = 'hidden';

        var htmlDecode = function(encodedData) {
            var decodedData = "";
            if (encodedData) {
                var div = document.createElement('div');
                div.innerHTML = encodedData;
                decodedData = div.firstChild.nodeValue.replace( /\\r\\n/ig , '\r\n');
            }
            return decodedData;
        };
                
        Galleries.iterateElem(Galleries.findElem(null, 'div', 'scriptcode'), function (index, scriptBlock) {
            var titleElem = Galleries.findElem(scriptBlock, 'div', 'title')[0];
            var labelElems = Galleries.findElem(titleElem, 'span');
            if (labelElems.length == 0) {
                labelElems = titleElem;
            }
            var languageSpans = Galleries.findElem(scriptBlock, 'span', 'hidden');
            var pres = Galleries.findElem(scriptBlock, 'pre');
            if (languageSpans.length > 0 && pres.length > 1) {
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    var languageSpan = languageSpans[index];
                            
                    elem.code = codePre.innerHTML.replace( /(\r(\n)?)|((\r)?\n)/ig , '\\r\\n');
                            
                    codePre.className = codePre.className.replace(hiddenPreClass, '');
                            
                    languageSpan.parentNode.removeChild(languageSpan);
                });

                pres = Galleries.findElem(scriptBlock, 'pre');
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    if (index == 0) {
                        scriptBlock.activeTab = 0;
                    }
                    else {
                        labelSpan.className += otherTabClass;
                        codePre.className += hiddenPreClass;
                    }
                    Galleries.attachEventHandler(labelSpan, 'click', function(e) {
                        var activeTab = scriptBlock.activeTab;
                        labelElems[activeTab].className += otherTabClass;
                        pres[activeTab].className += hiddenPreClass;

                        codePre.className = codePre.className.replace(hiddenPreClass, '');
                        labelSpan.className = labelSpan.className.replace(otherTabClass, '');
                        scriptBlock.activeTab = index;
                    });
                });

                var preview = Galleries.findElem(scriptBlock, 'div', 'preview');
                if (preview.length == 0) {
                    preview.push(pres[pres.length - 1]);
                }
                Galleries.iterateElem(preview, function(index, elem) {
                    elem.parentNode.removeChild(elem);
                });

                if (window.clipboardData && clipboardData.setData) {
                    var copyLink = document.createElement('a');
                    copyLink.href = 'javascript:void(0);';
                    copyLink.className = 'copyCode';
                    copyLink.innerHTML = 'Copy code';
                    Galleries.attachEventHandler(copyLink, 'click', function (e) {
                        clipboardData.setData("Text", htmlDecode(labelElems[scriptBlock.activeTab].code));
                        return false;
                    });
                    scriptBlock.insertBefore(copyLink, scriptBlock.childNodes[0]);
                }
            }
        });
    }

    Galleries.onWindowLoad(function(){
        initializePage();
    });

</script>
<div id="longDesc">
    
<p id="header"><span class="label">Summary:</span> Learn how to use the Lync 2013 API to search for people in Lync 2013 and start IM conversations with them.</p>
<div id="mainSection">
<div id="mainBody">
<div class="introduction">
<p>The Lync 2013 API includes a set of managed classes with methods that you can use to add collaboration functionality to your application. Using this Lync API, you can find users, start conversations, share resources, and initiate a meet-now meeting. This
 code sample shows you how to use the Lync 2013 API to search for people in Lync 2013 and start IM conversations with them.</p>
</div>
<h1 class="heading">Description of the sample</h1>
<div class="section" id="sectionSection0">
<div>The Windows Forms application consists of the following forms:</div>
<ul>
<li>
<div><strong>Login form</strong> - Before searching for people in Lync, you need to sign in to the Lync client by using this form.</div>
</li><li>
<div><strong>Search form</strong> - After signing in to the Lync client, use this form to search for people or contacts in Lync and start conversations with them. This form is shown in the following figure.</div>
</li></ul>
<div><img id="76694" src="description/O365_SearchPeopleLyncReadmeScreen2.JPG" alt="Lync people search window with empty result list" width="698" height="564"></div>
<div>&nbsp;</div>
<div>For more information about the Lync 2013 API, see <a href="http://msdn.microsoft.com/library/c46a20f0-2d18-4aa8-b7fb-980fd88135c9.aspx" >
Lync 2013 SDK documentation</a>.</div>
</div>
<h1 class="heading">Prerequisites</h1>
<div class="section" id="sectionSection1">
<div>This sample requires the following:</div>
<ul>
<li>
<div>Microsoft Visual Studio 2012.</div>
</li><li>
<div>Windows 7 or Windows 8.</div>
</li><li>
<div>Microsoft Office 2013.</div>
</li><li>
<div>Lync 2013 SDK.</div>
</li></ul>
</div>
<h1 class="heading">Key components of the sample</h1>
<div class="section" id="sectionSection2">
<div>The sample contains the following:</div>
<ul>
<li>
<div>The 0365_Lyncpeoplesearch_cs project.</div>
</li><li>
<div>The login.cs file.</div>
</li><li>
<div>The login.Designer.cs file, which includes the custom sign-in form that contains the C# code that uses the Lync 2013 API to sign a user in to Lync.</div>
</li><li>
<div>The Search.cs file.</div>
</li><li>
<div>The Search.Designer.cs file, which declares the custom sign-in form that contains the C# code that uses the Lync 2013 API to search for users and start IM conversations.</div>
</li></ul>
</div>
<h1 class="heading">Configure the sample</h1>
<div class="section" id="sectionSection3">
<div>Follow these steps to configure the sample app.</div>
<ol>
<li>
<div>Extract O365_lyncpeoplesearch_cs.zip into a folder.</div>
</li><li>
<div>Open O365_lyncpeoplesearch_cs.sln by using Visual Studio 2012 as an administrator.</div>
</li><li>
<div>Add a reference to the Microsoft.Lync.Model assembly, which you can find in C:\Program Files (x86)\Microsoft Office 2013\LyncSDK\Assemblies\Desktop.</div>
</li></ol>
</div>
<h1 class="heading">Build the sample</h1>
<div class="section" id="sectionSection4">
<p>Press F5 to build and run the sample.</p>
</div>
<h1 class="heading">Run and test the sample</h1>
<div class="section" id="sectionSection5">
<ol>
<li>
<p>If you are not signed in to Lync, click the <span class="ui">Sign In to Lync</span> button, and then go to step 2. If you are already signed in, go to step 3.</p>
<div><img id="76695" src="description/cf88ca9c-c043-4136-975a-4226b8f5c7fcO365_SearchPeopleLyncReadmeScreen2.JPG" alt="Lync people search window with empty result list" width="698" height="564"></div>
<div>&nbsp;</div>
</li><li>
<p>Enter your credentials on the <span class="ui">Login</span> form, and click the
<span class="ui">Sign In</span> button. Use your Office 365 user name. For example: &quot;&lt;YourName.CompanyName.onmicrosoft.com&gt;&quot;.</p>
<div><img id="76696" src="description/O365_SearchPeopleLyncReadmeScreen7.JPG" alt="Custom Lync sign in window" width="471" height="275"></div>
<div>&nbsp;</div>
</li><li>
<p>Enter the text (person's name) to search for, and click the <span class="ui">
Search</span> button.</p>
<div><img id="76697" src="description/O365_SearchPeopleLyncReadmeScreen3.JPG" alt="Lync people search window with search name typed" width="699" height="564"></div>
<div>&nbsp;</div>
<p>The search form shows a list of contacts that match the search text.</p>
<div><img id="76698" src="description/O365_SearchPeopleLyncReadmeScreen4.JPG" alt="Lync people search window with search results" width="698" height="565"></div>
<div>&nbsp;</div>
</li><li>
<p>Select the contact that you want to start a conversation with. Then, in the <span class="ui">
Message</span> box, type the message you want to send, and click the <span class="ui">
Start Conversation</span> button.</p>
<div><img id="76699" src="description/O365_SearchPeopleLyncReadmeScreen5.JPG" alt="Lync people search window with selected user" width="693" height="560"></div>
<div>&nbsp;</div>
<p>The IM conversation window opens, enabling you to start conversing with the contact.</p>
<div><img id="76700" src="description/O365_SearchPeopleLyncReadmeScreen6.JPG" alt="Lync conversation window with selected user" width="433" height="430"></div>
</li></ol>
</div>
<h1 class="heading">Change log</h1>
<div class="section" id="sectionSection6">
<div class="caption"></div>
<div class="tableSection">
<table cellspacing="2" cellpadding="5" width="50%" frame="lhs">
<tbody>
<tr>
<th>
<div>Version</div>
</th>
<th>
<div>Date</div>
</th>
</tr>
<tr>
<td>
<div>First version</div>
</td>
<td>
<div>February 28, 2013</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<h1 class="heading">Related content</h1>
<div class="section" id="sectionSection7">
<ul>
<li>
<div><a href="http://msdn.microsoft.com/library/c46a20f0-2d18-4aa8-b7fb-980fd88135c9.aspx" >Lync 2013 SDK documentation</a></div>
</li></ul>
</div>
</div>
</div>
<p>&nbsp;</p>

</div>


    </div>
</body>
</html>

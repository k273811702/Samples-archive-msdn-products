<!DOCTYPE html>
<html>
<head>
    <!-- IE9 or superior -->
    <meta http-equiv="X-UA-Compatible" content="IE=9">
    <title>People Picker JavaScript with options</title>

    <!-- Controls Specific CSS File -->
    <link rel="stylesheet" type="text/css" href="/Scripts/Office.Controls.css" />

    <!-- Ajax, jQuery, and utils -->
    <script src="../Scripts/MicrosoftAjax.js"></script>
    <script src="../Scripts/jquery-2.1.0.min.js"></script>
    <script src="../Scripts/utils.js" type="text/javascript"></script>

    <!-- Cross-Domain Library and Office controls runtime -->
    <script type="text/javascript">
        //Register namespace and variables used through the sample
        Type.registerNamespace("Office.Samples.PeoplePickerBasic");
        //Retrieve context tokens from the querystring
        Office.Samples.PeoplePickerBasic.appWebUrl =
            decodeURIComponent(getQueryStringParameter("SPAppWebUrl"));
        Office.Samples.PeoplePickerBasic.hostWebUrl =
            decodeURIComponent(getQueryStringParameter("SPHostUrl"));

        //Pattern to dynamically load JSOM and and the cross-domain library
        var scriptbase = Office.Samples.PeoplePickerBasic.hostWebUrl + "/_layouts/15/";

        $.getScript(scriptbase + "SP.RequestExecutor.js", //Get the cross-domain library
            //Get the Office controls runtime and continue to the createControl function
            function () { $.getScript("../Scripts/Office.Controls.js", createControl) }
        );
    </script>

    <!-- People Picker -->
    <script src="../Scripts/Office.Controls.PeoplePicker.js" type="text/javascript"></script>
</head>
<body>
    People Picker sample with options (JavaScript declaration):
    <div id="PeoplePickerDiv"></div>
    <span>Count : <span id="count">0</span></span>

    <script type="text/javascript">
        function createControl() {
            //Initialize Controls Runtime
            Office.Controls.Runtime.initialize({
                sharePointHostUrl: Office.Samples.PeoplePickerBasic.hostWebUrl,
                appWebUrl: Office.Samples.PeoplePickerBasic.appWebUrl
            });

            //Instantiate the control programmatically
            new Office.Controls.PeoplePicker(
                document.getElementById("PeoplePickerDiv"), {
                    allowMultipleSelections: true,
                    placeholder: "Check the count message, it changes when you add people...",
                    onChange: function (ctrl) {
                        document.getElementById("count").textContent = ctrl.selectedItems.length.toString();
                    }
                });
        }
    </script>

    <p>Return to the <a id="ret" href="#">list of samples</a>.</p>
    <script type="text/javascript">
        //Build the URL for the link above
        var link;
        var qs;

        qs = "?" + document.URL.split("?")[1];

        link = document.getElementById("ret");
        link.href = Office.Samples.PeoplePickerBasic.appWebUrl + "/Pages/PeoplePickerSamples.aspx" + qs;
    </script>
</body>
</html>

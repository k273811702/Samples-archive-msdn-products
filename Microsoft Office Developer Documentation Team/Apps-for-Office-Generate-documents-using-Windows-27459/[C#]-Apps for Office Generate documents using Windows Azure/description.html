<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head><link rel="stylesheet" type="text/css" href="description/Combined.css,0:ImageSprite,0:Header.NonMtps,1:LinkList;/Areas/Centers/Themes/MsdnBase/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;hashKey=E7E56B29F143D47BCA60969CE481A61D" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="description/fdddba7d-7b4b-4537-b10d-99bcd707d36eCombined.css,0:ImageSprite,0:Footer.NonMtps,1:LinkList;/Areas/Centers/Themes/MsdnBase/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;hashKey=CDD771F0B1A1A67679ABA1619E29D70B" xmlns="http://www.w3.org/1999/xhtml" />

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>Apps for Office: Generate documents using Windows Azure</title>
        <link href="description/Galleries.css" type="text/css" rel="Stylesheet" /><link href="description/Layout.css" type="text/css" rel="Stylesheet" /><link href="description/Brand.css" type="text/css" rel="Stylesheet" />
        <link href="description/iframedescription.css" rel="Stylesheet" type="text/css" />
        <script src="description/offline.js" type="text/javascript"></script>
        <style type="text/css">
            #projectInfo {
                overflow: auto;
            }
            #longDesc {
                clear:both;
                margin: 25px 0 10px 0;
            }

            #SampleIndexList{
                margin-left: 15px;
            }
        </style>
    </head>
<body>
    <div id="offlineDescription">
        <h1>Apps for Office: Generate documents using Windows Azure</h1>
        <br/>
        <div id="projectInfo">
            <div class="section">
                    <div class="itemBarLong tagsContainer">
                        <label for="Technologies">Technologies</label>
                        <div id="Technologies">
                            Windows Azure, Office 365, Word
                        </div>
                    </div>
                    <div class="itemBarLong tagsContainer">
                        <label for="Topics">Topics</label>
                        <div id="Topics">
                            apps for Office
                        </div>
                    </div>
                <div class="itemBarLong">
                    <label for="Platforms">Platforms</label>
                    <div id="Platforms">
                        Desktop
                    </div>
                </div>
                <div class="itemBarLong">
                    <label for="Requirements">Requirements</label>
                    <div id="Requirements">
                        
                    </div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Primary language</label>
                    <div id="LastUpdated">en-US</div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Updated</label>
                    <div id="LastUpdated">3/1/2014</div>
                </div>
                <div class="itemBarLong">
                    <label for="License">License</label>
                    <div id="License">
                        <a href="license.rtf">Apache License, Version 2.0</a></div>
                </div>
                <div class="itemBar">
                    <div class="viewonlinecont">
                        <a data-link="online" href="http://code.msdn.microsoft.com/Apps-for-Office-Generate-b8a13d5a">View this sample online</a>
                    </div>
                </div>
            </div>
        </div>
        
                   
<script type="text/javascript">
    function initializePage() {
        var otherTabClass = 'otherTab';
        var hiddenPreClass = 'hidden';

        var htmlDecode = function(encodedData) {
            var decodedData = "";
            if (encodedData) {
                var div = document.createElement('div');
                div.innerHTML = encodedData;
                decodedData = div.firstChild.nodeValue.replace( /\\r\\n/ig , '\r\n');
            }
            return decodedData;
        };
                
        Galleries.iterateElem(Galleries.findElem(null, 'div', 'scriptcode'), function (index, scriptBlock) {
            var titleElem = Galleries.findElem(scriptBlock, 'div', 'title')[0];
            var labelElems = Galleries.findElem(titleElem, 'span');
            if (labelElems.length == 0) {
                labelElems = titleElem;
            }
            var languageSpans = Galleries.findElem(scriptBlock, 'span', 'hidden');
            var pres = Galleries.findElem(scriptBlock, 'pre');
            if (languageSpans.length > 0 && pres.length > 1) {
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    var languageSpan = languageSpans[index];
                            
                    elem.code = codePre.innerHTML.replace( /(\r(\n)?)|((\r)?\n)/ig , '\\r\\n');
                            
                    codePre.className = codePre.className.replace(hiddenPreClass, '');
                            
                    languageSpan.parentNode.removeChild(languageSpan);
                });

                pres = Galleries.findElem(scriptBlock, 'pre');
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    if (index == 0) {
                        scriptBlock.activeTab = 0;
                    }
                    else {
                        labelSpan.className += otherTabClass;
                        codePre.className += hiddenPreClass;
                    }
                    Galleries.attachEventHandler(labelSpan, 'click', function(e) {
                        var activeTab = scriptBlock.activeTab;
                        labelElems[activeTab].className += otherTabClass;
                        pres[activeTab].className += hiddenPreClass;

                        codePre.className = codePre.className.replace(hiddenPreClass, '');
                        labelSpan.className = labelSpan.className.replace(otherTabClass, '');
                        scriptBlock.activeTab = index;
                    });
                });

                var preview = Galleries.findElem(scriptBlock, 'div', 'preview');
                if (preview.length == 0) {
                    preview.push(pres[pres.length - 1]);
                }
                Galleries.iterateElem(preview, function(index, elem) {
                    elem.parentNode.removeChild(elem);
                });

                if (window.clipboardData && clipboardData.setData) {
                    var copyLink = document.createElement('a');
                    copyLink.href = 'javascript:void(0);';
                    copyLink.className = 'copyCode';
                    copyLink.innerHTML = 'Copy code';
                    Galleries.attachEventHandler(copyLink, 'click', function (e) {
                        clipboardData.setData("Text", htmlDecode(labelElems[scriptBlock.activeTab].code));
                        return false;
                    });
                    scriptBlock.insertBefore(copyLink, scriptBlock.childNodes[0]);
                }
            }
        });
    }

    Galleries.onWindowLoad(function(){
        initializePage();
    });

</script>
<div id="longDesc">
    
<div id="header">
<table id="bottomTable" cellspacing="0" cellpadding="0">
<tbody>
<tr id="headerTableRow1">
<td align="left"><span id="runningHeaderText">&nbsp;</span></td>
</tr>
<tr id="headerTableRow2">
<td align="left"><span id="nsrTitle">Apps for Office: Generate documents using Windows Azure</span></td>
</tr>
</tbody>
</table>
</div>
<div id="mainSection">
<div id="mainBody">
<div>
<p><strong>Last modified: </strong>February 06, 2014</p>
<p><strong>In this article</strong> <br>
<a href="#sectionSection0">Description</a> <br>
<a href="#sectionSection1">Prerequisites</a> <br>
<a href="#sectionSection2">Key components</a> <br>
<a href="#sectionSection3">Configure the sample</a> <br>
<a href="#sectionSection4">Build the sample</a> <br>
<a href="#sectionSection5">Run and test the sample</a> <br>
<a href="#sectionSection6">Troubleshooting</a> <br>
<a href="#sectionSection7">Change log</a> <br>
<a href="#sectionSection8">Related content</a></p>
<p><span>Summary:</span> Demonstrates an app for Word that allows you to create and insert user-defined blocks of content into a document using Windows Azure as the storage backend.</p>
</div>
<h1>Description</h1>
<div id="sectionSection0">
<p><span>Provided by:</span> <a href="http://3sharp.com/" >Thomas Mechelke</a>, 3Sharp</p>
<p>The app in this code sample inserts blocks of content into an Office document. The app provides sample content that you can insert, but also lets you create and store your own blocks of content that you can insert into a document. You can also categorize
 your blocks of content by using categories that you define. To insert a block of content, the user chooses the label that corresponds to the kind of content that they want.</p>
<p>The sample content blocks are stored as Office Open XML code inside the app. The user-defined blocks of content are stored as Windows Azure Blobs. For this sample, the Windows Azure storage container name and key are hardcoded in the Web.config file for
 the app.</p>
<p>Figure 1 shows the completed app after it was inserted into the Office application.</p>
<strong>
<div class="caption">Figure 1. The document generation app user interface when you first insert the app.</div>
</strong><br>
<strong>&nbsp;</strong><img src="description/image.png" alt="">
<p>Figure 2 shows a Smart Art diagram on the document surface that was inserted using the app.</p>
<strong>
<div class="caption">Figure 2. A Smart Art diagram displayed on the document surface.</div>
</strong><br>
<strong>&nbsp;</strong><img src="description/0c8ec9a3-7c94-444c-ba20-c52c04fd8724image.png" alt=""></div>
<h1>Prerequisites</h1>
<div id="sectionSection1">
<p>This sample requires the following:</p>
<ul>
<li>
<p>Word 2013</p>
</li><li>
<p>Visual Studio 2012 with Office Developer Tools for Visual Studio 2012, or Visual Studio 2013</p>
</li><li>
<p>Internet Explorer 9 or later</p>
</li><li>
<p>Windows Azure subscription.</p>
<p>For information about how to get a Windows Azure subscription, see the <a href="http://www.windowsazure.com/en-us/pricing/free-trial/" >
Windows Azure portal</a>.</p>
</li></ul>
</div>
<h1>Key components</h1>
<div id="sectionSection2">
<p>&nbsp;</p>
<ul>
<li>
<p>DocGenAppForOffice project</p>
<ul>
<li>
<p>DocGenAppForOffice.xml manifest file</p>
</li></ul>
</li><li>
<p>DocGenAppForOfficeWeb project</p>
<ul>
<li>
<p>Home.html file, which contains the HTML control for the app's user interface.</p>
</li><li>
<p>Home.js file, which contains the event handler for the <strong><span class="keyword">Office.initialize</span></strong> event of the app, and handles the button click event for the app's button.</p>
</li><li>
<p>Home.css file, which contains the styling for the elements shown in the app UI.</p>
</li><li>
<p>Controllers folder</p>
<ul>
<li>
<p>CategoriesController.cs</p>
</li><li>
<p>DocSectionsController.cs</p>
</li><li>
<p>SampleDataController.cs</p>
</li></ul>
<p>These files define classes that provide access to the Windows Azure Storage Container and to the sample data that is hardcoded into the app.</p>
</li><li>
<p>SampleData folder, which contains the Office Open XML for each of the sample content types included in the app.</p>
</li></ul>
</li></ul>
</div>
<h1>Configure the sample</h1>
<div id="sectionSection3">
<p>To configure the app, you have to create a Windows Azure Storage Container and then copy the Storage Container name and a Storage Container key to the Web.config file for the app. The app reads and writes to the Windows Azure Storage Container to store document
 section categories and sections.</p>
<div>
<table cellspacing="0" cellpadding="0" width="100%">
<tbody>
<tr>
<th align="left"><strong>Note</strong> </th>
</tr>
<tr>
<td>
<p>The description of the Windows Azure management portal that follows was accurate as of the time of publishing this app to the MSDN Code Gallery. The Windows Azure portal website may have changed by the time that you read this but the basic steps to create
 a Windows Azure Storage Container should resemble the steps given in this section.</p>
</td>
</tr>
</tbody>
</table>
</div>
<div>
<ol>
<li>
<p>Sign in to the Windows Azure<a href="http://code.msdn.microsoft.com/Apps-for-Office-Generate-b8a13d5a/https://manage.windowsazure.com" >management portal</a>.</p>
</li><li>
<p>At the bottom of the page, choose <strong><span class="ui">NEW</span></strong>.</p>
</li><li>
<p>Under <strong><span class="ui">NEW</span></strong>, choose <strong><span class="ui">DATA SERVICE</span></strong>INVALID USE OF SYMBOLS<strong><span class="ui">STORAGE</span></strong>INVALID USE OF SYMBOLS<strong><span class="ui">QUICK CREATE</span></strong>.</p>
</li><li>
<p>For <strong><span class="ui">URL</span></strong>, enter a storage name. Windows Azure makes sure the name that you enter is unique across the system and will notify you if the name has already been selected by another customer.</p>
</li><li>
<p>For <strong><span class="ui">LOCATION/AFFINITY GROUP</span></strong>, choose a geographic location near you.</p>
</li><li>
<p>Accept the default choice for <strong><span class="ui">REPLICATION</span></strong>.</p>
</li><li>
<p>Choose <strong><span class="ui">CREATE STORAGE ACCOUNT</span></strong>.</p>
</li><li>
<p>After a few moments, Windows Azure finishes creating the storage container and sets the container status to
<strong><span class="ui">Online</span></strong>.</p>
</li><li>
<p>At the bottom of the page, choose <strong><span class="ui">MANAGE ACCESS KEYS</span></strong>.</p>
</li><li>
<p>Choose the copy button for either the primary or secondary access key</p>
</li><li>
<p>In Solution Explorer in Visual Studio, expand <strong><span class="ui">DocGenAppForOfficeWeb</span></strong>, and then double-click
<strong><span class="ui">Web.config</span></strong>.</p>
</li><li>
<p>In the editor pane for Web.config, find the child element, <span><strong>[add]</strong></span>, in the
<span><strong>[connectionStrings]</strong></span> element.</p>
</li><li>
<p>Replace the entry for the <span><strong>[AccountName]</strong></span> attribute with your Windows Azure Storage Container name and the
<span><strong>[AccountKey]</strong></span> attribute with the access key for the container.</p>
</li><li>
<p>Choose FileINVALID USE OF SYMBOLS Save All to save your changes.</p>
</li></ol>
</div>
</div>
<h1>Build the sample</h1>
<div id="sectionSection4">
<p>Choose the F5 key to build and deploy the app.</p>
</div>
<h1>Run and test the sample</h1>
<div id="sectionSection5">
<p>Choose the F5 key to build and deploy the app.</p>
</div>
<h1>Troubleshooting</h1>
<div id="sectionSection6">
<p>If the app is not installed, ensure that the XML in your <strong>AppManifest.xml</strong> file parses correctly.</p>
<p>Check that you have replaced the placeholders in the app's Web.Config file with your Windows Azure Storage Container and Storage Container key.</p>
</div>
<h1>Change log</h1>
<div id="sectionSection7">
<p>First release: Feb 2014</p>
</div>
<h1>Related content</h1>
<div id="sectionSection8">
<ul>
<li>
<p><a href="http://msdn.microsoft.com/en-us/library/office/apps/fp123513.aspx" >Reading and writing data to the active selection in a document or spreadsheet</a></p>
</li><li>
<p><a href="http://msdn.microsoft.com/library/c5bad651-a42f-4e57-bc60-c9b27eb2383b(Office.15).aspx" >Creating better apps for Word with Office Open XML</a></p>
</li><li>
<p><span><a href="http://code.msdn.microsoft.com/Apps-for-Office-Generate-b8a13d5a/1561bf17-122e-4510-b1ce-7c7c346cdec9.htm">How to: Host an app for Office on Windows Azure</a>
</span></p>
</li></ul>
</div>
</div>
</div>

</div>


    </div>
</body>
</html>

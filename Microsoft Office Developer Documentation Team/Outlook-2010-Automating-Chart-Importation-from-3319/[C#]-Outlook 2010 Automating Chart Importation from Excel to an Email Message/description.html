<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head><link rel="stylesheet" type="text/css" href="description/Combined.css,1:ImageSprite;/Areas/Epx/Themes/Msdn/Content:0,/Areas/Epx/Content/Css:1&amp;amp;hashKey=E7560C71640616C5057FAEACB58DCB00" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="description/2f95808e-ca34-4249-88ff-44fabe33cdc0Combined.css,1:LinkList,2:ImageSprite,2:SiteFeedbackLink;/Areas/Epx/Themes/Msdn/Content:0,/Areas/Epx/Themes/Base/Content:1,/Areas/Epx/Content/Css:2&amp;amp;hashKey=EEE39C2D6B93379FDAF50337BE99AF8C" xmlns="http://www.w3.org/1999/xhtml" />

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>Outlook 2010: Automating Chart Importation from Excel to an Email Message</title>
        <link href="description/Galleries.css" type="text/css" rel="Stylesheet" /><link href="description/Layout.css" type="text/css" rel="Stylesheet" /><link href="description/Brand.css" type="text/css" rel="Stylesheet" />
        <link href="description/iframedescription.css" rel="Stylesheet" type="text/css" />
        <script src="description/offline.js" type="text/javascript"></script>
        <style type="text/css">
            #projectInfo {
                overflow: auto;
            }
            #longDesc {
                clear:both;
                margin: 25px 0 10px 0;
            }

            #SampleIndexList{
                margin-left: 15px;
            }
        </style>
    </head>
<body>
    <div id="offlineDescription">
        <h1>Outlook 2010: Automating Chart Importation from Excel to an Email Message</h1>
        <br/>
        <div id="projectInfo">
            <div class="section">
                    <div class="itemBarLong tagsContainer">
                        <label for="Technologies">Technologies</label>
                        <div id="Technologies">
                            Office, Outlook 2010, Excel 2010, Word 2010
                        </div>
                    </div>
                    <div class="itemBarLong tagsContainer">
                        <label for="Topics">Topics</label>
                        <div id="Topics">
                            Ribbon Extensibility, Automation
                        </div>
                    </div>
                <div class="itemBarLong">
                    <label for="Platforms">Platforms</label>
                    <div id="Platforms">
                        Desktop
                    </div>
                </div>
                <div class="itemBarLong">
                    <label for="Requirements">Requirements</label>
                    <div id="Requirements">
                        
                    </div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Primary Language</label>
                    <div id="LastUpdated">en-US</div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Last Updated</label>
                    <div id="LastUpdated">6/7/2011</div>
                </div>
                <div class="itemBarLong">
                    <label for="License">License</label>
                    <div id="License">
                        <a href="license.rtf">Apache License, Version 2.0</a></div>
                </div>
                <div class="itemBar">
                    <div class="viewonlinecont">
                        <a data-link="online" href="http://code.msdn.microsoft.com/Outlook-2010-Automating-0e6e38fc">View this sample online</a>
                    </div>
                </div>
            </div>
        </div>
        
                   
<script type="text/javascript">
    function initializePage() {
        var otherTabClass = 'otherTab';
        var hiddenPreClass = 'hidden';

        var htmlDecode = function(encodedData) {
            var decodedData = "";
            if (encodedData) {
                var div = document.createElement('div');
                div.innerHTML = encodedData;
                decodedData = div.firstChild.nodeValue.replace( /\\r\\n/ig , '\r\n');
            }
            return decodedData;
        };
                
        Galleries.iterateElem(Galleries.findElem(null, 'div', 'scriptcode'), function (index, scriptBlock) {
            var titleElem = Galleries.findElem(scriptBlock, 'div', 'title')[0];
            var labelElems = Galleries.findElem(titleElem, 'span');
            if (labelElems.length == 0) {
                labelElems = titleElem;
            }
            var languageSpans = Galleries.findElem(scriptBlock, 'span', 'hidden');
            var pres = Galleries.findElem(scriptBlock, 'pre');
            if (languageSpans.length > 0 && pres.length > 1) {
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    var languageSpan = languageSpans[index];
                            
                    elem.code = codePre.innerHTML.replace( /(\r(\n)?)|((\r)?\n)/ig , '\\r\\n');
                            
                    codePre.className = codePre.className.replace(hiddenPreClass, '');
                            
                    languageSpan.parentNode.removeChild(languageSpan);
                });

                pres = Galleries.findElem(scriptBlock, 'pre');
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    if (index == 0) {
                        scriptBlock.activeTab = 0;
                    }
                    else {
                        labelSpan.className += otherTabClass;
                        codePre.className += hiddenPreClass;
                    }
                    Galleries.attachEventHandler(labelSpan, 'click', function(e) {
                        var activeTab = scriptBlock.activeTab;
                        labelElems[activeTab].className += otherTabClass;
                        pres[activeTab].className += hiddenPreClass;

                        codePre.className = codePre.className.replace(hiddenPreClass, '');
                        labelSpan.className = labelSpan.className.replace(otherTabClass, '');
                        scriptBlock.activeTab = index;
                    });
                });

                var preview = Galleries.findElem(scriptBlock, 'div', 'preview');
                if (preview.length == 0) {
                    preview.push(pres[pres.length - 1]);
                }
                Galleries.iterateElem(preview, function(index, elem) {
                    elem.parentNode.removeChild(elem);
                });

                if (window.clipboardData && clipboardData.setData) {
                    var copyLink = document.createElement('a');
                    copyLink.href = 'javascript:void(0);';
                    copyLink.className = 'copyCode';
                    copyLink.innerHTML = 'Copy Code';
                    Galleries.attachEventHandler(copyLink, 'click', function (e) {
                        clipboardData.setData("Text", htmlDecode(labelElems[scriptBlock.activeTab].code));
                        return false;
                    });
                    scriptBlock.insertBefore(copyLink, scriptBlock.childNodes[0]);
                }
            }
        });
    }

    Galleries.onWindowLoad(function(){
        initializePage();
    });

</script>
<div id="longDesc">
    
<h1><span style="font-size:medium">Introduction</span></h1>
<p><span style="font-family:verdana,geneva; font-size:small">This C# sample&nbsp;is an&nbsp;Outloook 2010 add-in that automates opening an Excel workbook, copying a chart from the workbook, and pasting the chart into an Outlook email message. This sample accompanies
 the Visual How To <a href="http://msdn.microsoft.com/en-us/library/hh227293.aspx" >
Automating Chart Importation from Excel to an Email Message in Outlook 2010</a> in the MSDN Library.</span></p>
<p><span style="font-family:verdana,geneva; font-size:small">The add-in provides a custom user interface in Outlook for you to select and copy a chart from an Excel workbook to an email message in compose mode.&nbsp;The&nbsp;Visual How To that accompanies this
 sample&nbsp;assumes you are familiar with C# and creating add-ins for Outlook.</span></p>
<h1><span style="font-size:medium">Source Code Files</span></h1>
<p><span style="font-size:small">The Outlook add-in solution is named ImportExcelChartToOutlook_AddIn_CS. The solution contains the following noteworthy classes:</span></p>
<ul>
<li><span style="font-size:small">ThisAddIn.cs&mdash;Initializes the add-in, declares instance variables, and adds a custom event handler for a new inspector. Also cleans up instance variables for the add-in upon shutdown.</span>
</li><li><span style="font-size:small">Ribbon1.cs&mdash;Provides a custom ribbon for mail inspectors in compose mode. Specifies the ribbon XML in Ribbon1.xml, and implements various methods to load the custom ribbon and display it in the appropriate context. Also
 implements the button callback method to open a workbook and copy a chart to a message.</span>
</li></ul>
<h1><span style="font-size:small">To build the add-in</span></h1>
<ol>
<li><span style="font-size:small">Open Windows Explorer and navigate to the folder where you unzipped the solution.</span>
</li><li><span style="font-size:small">Double-click the ImportExcelChartToOutlook_AddIn_CS.sln (solution) file to open the file in Visual Studio.</span>
</li><li><span style="font-size:small">In the Build menu, select Build Solution. The application will be built in the default \Debug or \Release directory.</span>
</li></ol>
<p><span style="font-size:small"><strong>To run the add-in</strong></span></p>
<ol>
<li><span style="font-size:small">Close Outlook if it is already running.</span> </li><li><span style="font-size:small">Follow the steps in the last section to build the sample if you have not already done so.</span>
</li><li><span style="font-size:small">In Visual Studio 2010, click the Debug menu, and then click Start Without Debugging. This starts Outlook.</span>
</li><li><span style="font-size:small">In Outlook, create a new email message.</span> </li><li><span style="font-size:small">On the custom ribbon tab, MyTab, click Copy Excel Chart.</span>
</li></ol>

</div>


    </div>
</body>
</html>

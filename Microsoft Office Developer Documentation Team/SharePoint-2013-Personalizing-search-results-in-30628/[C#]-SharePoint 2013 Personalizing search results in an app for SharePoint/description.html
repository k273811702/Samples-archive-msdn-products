<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head><link rel="stylesheet" type="text/css" href="description/Combined.css,0:HeaderFooterSprite,0:Header.NonMtps,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;hashKey=62DBC035A4A8AD76676CA11B61CB6C59" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="description/8b340e41-7f14-459e-8b3a-1aa6a9a05c7fCombined.css,0:HeaderFooterSprite,0:Footer.NonMtps,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;hashKey=46CB1877D3C0B7D6D06D21CECE7C9CAB" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>SharePoint 2013: Personalizing search results in an app for SharePoint</title>
        <link href="description/Galleries.css" type="text/css" rel="Stylesheet" /><link href="description/Layout.css" type="text/css" rel="Stylesheet" /><link href="description/Brand.css" type="text/css" rel="Stylesheet" />
        <link href="description/iframedescription.css" rel="Stylesheet" type="text/css" />
        <script src="description/offline.js" type="text/javascript"></script>
        <style type="text/css">
            #projectInfo {
                overflow: auto;
            }
            #longDesc {
                clear:both;
                margin: 25px 0 10px 0;
            }

            #SampleIndexList{
                margin-left: 15px;
            }
        </style>
    </head>
<body>
    <div id="offlineDescription">
        <h1>SharePoint 2013: Personalizing search results in an app for SharePoint</h1>
        <br/>
        <div id="projectInfo">
            <div class="section">
                    <div class="itemBarLong tagsContainer">
                        <label for="Technologies">Technologies</label>
                        <div id="Technologies">
                            SharePoint Server 2013, apps for SharePoint
                        </div>
                    </div>
                    <div class="itemBarLong tagsContainer">
                        <label for="Topics">Topics</label>
                        <div id="Topics">
                            Search, Configuration, SharePoint client object model (CSOM)
                        </div>
                    </div>
                <div class="itemBarLong">
                    <label for="Platforms">Platforms</label>
                    <div id="Platforms">
                        Cloud
                    </div>
                </div>
                <div class="itemBarLong">
                    <label for="Requirements">Requirements</label>
                    <div id="Requirements">
                        
                    </div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Primary language</label>
                    <div id="LastUpdated">en-US</div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Updated</label>
                    <div id="LastUpdated">8/29/2014</div>
                </div>
                <div class="itemBarLong">
                    <label for="License">License</label>
                    <div id="License">
                        <a href="license.rtf">Apache License, Version 2.0</a></div>
                </div>
                <div class="itemBar">
                    <div class="viewonlinecont">
                        <a data-link="online" href="http://code.msdn.microsoft.com/SharePoint-2013-Personalizi-fb6ddcf9">View this sample online</a>
                    </div>
                </div>
            </div>
        </div>
        
                   
<script type="text/javascript">
    function initializePage() {
        var otherTabClass = 'otherTab';
        var hiddenPreClass = 'hidden';

        var htmlDecode = function(encodedData) {
            var decodedData = "";
            if (encodedData) {
                var div = document.createElement('div');
                div.innerHTML = encodedData;
                decodedData = div.firstChild.nodeValue.replace( /\\r\\n/ig , '\r\n');
            }
            return decodedData;
        };
                
        Galleries.iterateElem(Galleries.findElem(null, 'div', 'scriptcode'), function (index, scriptBlock) {
            var titleElem = Galleries.findElem(scriptBlock, 'div', 'title')[0];
            var labelElems = Galleries.findElem(titleElem, 'span');
            if (labelElems.length == 0) {
                labelElems = titleElem;
            }
            var languageSpans = Galleries.findElem(scriptBlock, 'span', 'hidden');
            var pres = Galleries.findElem(scriptBlock, 'pre');
            if (languageSpans.length > 0 && pres.length > 1) {
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    var languageSpan = languageSpans[index];
                            
                    elem.code = codePre.innerHTML.replace( /(\r(\n)?)|((\r)?\n)/ig , '\\r\\n');
                            
                    codePre.className = codePre.className.replace(hiddenPreClass, '');
                            
                    languageSpan.parentNode.removeChild(languageSpan);
                });

                pres = Galleries.findElem(scriptBlock, 'pre');
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    if (index == 0) {
                        scriptBlock.activeTab = 0;
                    }
                    else {
                        labelSpan.className += otherTabClass;
                        codePre.className += hiddenPreClass;
                    }
                    Galleries.attachEventHandler(labelSpan, 'click', function(e) {
                        var activeTab = scriptBlock.activeTab;
                        labelElems[activeTab].className += otherTabClass;
                        pres[activeTab].className += hiddenPreClass;

                        codePre.className = codePre.className.replace(hiddenPreClass, '');
                        labelSpan.className = labelSpan.className.replace(otherTabClass, '');
                        scriptBlock.activeTab = index;
                    });
                });

                var preview = Galleries.findElem(scriptBlock, 'div', 'preview');
                if (preview.length == 0) {
                    preview.push(pres[pres.length - 1]);
                }
                Galleries.iterateElem(preview, function(index, elem) {
                    elem.parentNode.removeChild(elem);
                });

                if (window.clipboardData && clipboardData.setData) {
                    var copyLink = document.createElement('a');
                    copyLink.href = 'javascript:void(0);';
                    copyLink.className = 'copyCode';
                    copyLink.innerHTML = 'Copy code';
                    Galleries.attachEventHandler(copyLink, 'click', function (e) {
                        clipboardData.setData("Text", htmlDecode(labelElems[scriptBlock.activeTab].code));
                        return false;
                    });
                    scriptBlock.insertBefore(copyLink, scriptBlock.childNodes[0]);
                }
            }
        });
    }

    Galleries.onWindowLoad(function(){
        initializePage();
    });

</script>
<div id="longDesc">
    
<div id="header">
<table id="bottomTable" cellspacing="0" cellpadding="0">
<tbody>
<tr id="headerTableRow2">
<td align="left"><strong><span id="nsrTitle" style="font-size:small">SharePoint 2013: Personalizing search results using the search query CSOM in an app for SharePoint</span></strong></td>
</tr>
</tbody>
</table>
</div>
<div id="mainSection">
<div id="mainBody">
<div class="summary">
<p><span class="label">Summary:</span>&nbsp;&nbsp;Learn how to use the SharePoint search query CSOM to return search results in an app for SharePoint.</p>
</div>
<div class="introduction">
<p><strong>Last modified:&nbsp;</strong>August 26, 2014</p>
<p><strong>In this article</strong><br>
<a href="http://code.msdn.microsoft.com/SharePoint-2013-Personalizi-fb6ddcf9/file://ipoawsfs201/DropZone/Rawhide/FileDropOff/jowest/Search.PersonalizedResults/SearchPersonalizedResults.htm#O15Readme_Description">Description of the sample</a><br>
<a href="http://code.msdn.microsoft.com/SharePoint-2013-Personalizi-fb6ddcf9/file://ipoawsfs201/DropZone/Rawhide/FileDropOff/jowest/Search.PersonalizedResults/SearchPersonalizedResults.htm#O15Readme_Prereq">Prerequisites</a><br>
<a href="http://code.msdn.microsoft.com/SharePoint-2013-Personalizi-fb6ddcf9/file://ipoawsfs201/DropZone/Rawhide/FileDropOff/jowest/Search.PersonalizedResults/SearchPersonalizedResults.htm#O15Readme_components">Key components of the sample</a><br>
<a href="http://code.msdn.microsoft.com/SharePoint-2013-Personalizi-fb6ddcf9/file://ipoawsfs201/DropZone/Rawhide/FileDropOff/jowest/Search.PersonalizedResults/SearchPersonalizedResults.htm#sectionSection3">Configure the sample</a><br>
<a href="http://code.msdn.microsoft.com/SharePoint-2013-Personalizi-fb6ddcf9/file://ipoawsfs201/DropZone/Rawhide/FileDropOff/jowest/Search.PersonalizedResults/SearchPersonalizedResults.htm#O15Readme_build">Run and test the sample</a><br>
<a href="http://code.msdn.microsoft.com/SharePoint-2013-Personalizi-fb6ddcf9/file://ipoawsfs201/DropZone/Rawhide/FileDropOff/jowest/Search.PersonalizedResults/SearchPersonalizedResults.htm#sectionSection5">Next steps</a><br>
<a href="http://code.msdn.microsoft.com/SharePoint-2013-Personalizi-fb6ddcf9/file://ipoawsfs201/DropZone/Rawhide/FileDropOff/jowest/Search.PersonalizedResults/SearchPersonalizedResults.htm#O15Readme_Changelog">Change log</a><br>
<a href="http://code.msdn.microsoft.com/SharePoint-2013-Personalizi-fb6ddcf9/file://ipoawsfs201/DropZone/Rawhide/FileDropOff/jowest/Search.PersonalizedResults/SearchPersonalizedResults.htm#O15Readme_RelatedContent">Related content</a></p>
<p>&nbsp;</p>
</div>
<a name="O15Readme_Description">
<h2 class="heading">Description of the sample</h2>
<div class="section" id="sectionSection0">
<p>This sample app for SharePoint shows how to use the search query CSOM to return search results, first just based on the user's query, and second, personalized based on the user submitting the query.</p>
<p>The basic search example allows the user to provide a search filter to be used for a tenant-wide search and is looking for sites that apply to the user-supplied filter.</p>
<p>The personalized search results example loads your user profile properties and checks for &quot;Apptest&quot; in the AboutMe profile property. If it is found, a list of site templates of any type is returned in the search results. If it is not found, only STS web
 templates are returned in the search results.</p>
</div>
</a><a name="O15Readme_Prereq">
<h2 class="heading">Prerequisites</h2>
<div class="section" id="sectionSection1">
<p>This sample requires the following:</p>
<ul>
<li>
<p>Visual Studio 2012 or Visual Studio 2013</p>
</li><li>
<p>Microsoft Office Developer tools for Visual Studio 2012 or Visual Studio 2013</p>
</li><li>
<p>SharePoint 2013 development environment</p>
</li></ul>
</div>
</a><a name="O15Readme_components">
<h2 class="heading">Key components of the sample</h2>
<div class="section" id="sectionSection2">
<p>The sample app contains the following:</p>
<ul>
<li>
<p><strong>Search.PersonalizedResults</strong>&nbsp;project, the app for SharePoint project.</p>
</li><li>
<p><strong>Search.PersonalizedResultsWeb</strong>&nbsp;project, the ASP.NET web application project.</p>
</li><li>
<p><strong>Default.aspx.</strong>&nbsp;located in the Search.PersonalizedSearchResults\PersonalizedSearchResultsWeb\Pages directory, which contains the HTML and ASP.NET controls for the sample's user interface</p>
</li><li>
<p><strong>Default.aspx.cs</strong>&nbsp;located the PersonalizedSearchResultsWeb\Pages directory, which contains the code that submits both the basic search and the personalized search queries to SharePoint. The code also parses and writes out the search results
 returned.</p>
</li><li>
<p><strong>SharePointContext.cs</strong>&nbsp;located in the Search.PersonalizedSearchResults\PersonalizedSearchResultsWeb directory, which encapsulates the information that the sample app needs to get from SharePoint.</p>
</li></ul>
</div>
</a><a name="sectionSection3"></a>
<h2 class="heading">Configure the sample</h2>
<div class="section" id="sectionSection3">
<p>Update the&nbsp;<span class="ui">Site URL</span>&nbsp;property of the&nbsp;<strong>Search.PersonalizedResults</strong>&nbsp;app for SharePoint project with the URL of your SharePoint site. You may be prompted to enter your credentials to access the site.</p>
</div>
<a name="O15Readme_build">
<h2 class="heading">Run and test the sample</h2>
<div class="section" id="sectionSection4">
<p>To run and test the sample, do the following:</p>
<ol>
<li>
<p>Press&nbsp;<span class="ui">F5</span>&nbsp;to run the app.</p>
</li><li>
<p>Sign in to your SharePoint site if you are prompted to do so by the browser.</p>
</li><li>
<p>If you are prompted to trust the self-signed Localhost certificate, click&nbsp;<span class="ui">Yes</span>.</p>
<p class="caption">Figure 1. Security alert: self-signed certificate.</p>
<p><img id="124540" src="description/PersonalSearch_TrustCertificate.PNG" alt="" width="618" height="273"><br>
<br>
You may also be prompted to install the certificate, if so, click&nbsp;<span class="ui">Yes</span>.</p>
<p class="caption">Figure 2. Security warning: install certificate.</p>
<p><img id="124541" src="description/PersonalSearch_InstallCertificate.PNG" alt="" width="491" height="405"></p>
<p>&nbsp;</p>
</li><li>
<p>On the consent page to grant permissions to the app, select&nbsp;<span class="ui">Trust It</span>.</p>
<div class="caption">Figure 3. Grant app permissions</div>
<br>
<img id="124547" src="description/PersonalSearch_TrustApp.PNG" alt="" width="708" height="253">
</li></ol>
<p><br>
<br>
You should now see the app displayed in the browser.</p>
<div class="caption">Figure 4. Personalized search results app.</div>
<div class="caption"></div>
<p class="caption"><img id="124543" src="description/PersonalSearch_AppPage.PNG" alt="" width="1033" height="487"></p>
<br>
<br>
</div>
</a><a name="sectionSection5"></a>
<h2 class="heading">Next steps</h2>
<div class="section" id="sectionSection5">
<p>See&nbsp;<a href="http://msdn.microsoft.com/en-us/library/office/fp179933(v=office.15).aspx" >Deploying and installing apps for SharePoint: methods and options</a>&nbsp;for instructions on how to publish your app.</p>
</div>
<a name="O15Readme_Changelog">
<h2 class="heading">Change log</h2>
<div class="section" id="sectionSection6">
<p>First release.</p>
</div>
</a><a name="O15Readme_RelatedContent">
<h2 class="heading">Related content</h2>
</a>
<div class="section" id="sectionSection7"><a name="O15Readme_RelatedContent"></a>
<ul>
<a name="O15Readme_RelatedContent"></a>
<li><a name="O15Readme_RelatedContent"></a>
<p><a name="O15Readme_RelatedContent"></a><a href="http://msdn.microsoft.com/en-us/library/office/dn423226(v=office.15).aspx" >Using the SharePoint 2013 search Query APIs</a></p>
</li><li>
<p><a href="http://msdn.microsoft.com/en-us/library/office/dn554260(v=office.15).aspx" >Search apps in SharePoint 2013</a></p>
</li></ul>
</div>
</div>
</div>

</div>


    </div>
</body>
</html>

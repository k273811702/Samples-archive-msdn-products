<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head><link rel="stylesheet" type="text/css" href="description/Combined.css,0:HeaderFooterSprite,0:Header.NonMtps,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;hashKey=C9973DA951AE6202C9B348379A1BE49D" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="description/9bf1b74c-1640-46af-84d3-e440c8f95162Combined.css,0:HeaderFooterSprite,0:Footer.NonMtps,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;hashKey=F576C687BC536B84D6E5B3246EE39B49" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>SharePoint 2010: Attaching File from Custom Web View to Outlook Message (Client)</title>
        <link href="description/Galleries.css" type="text/css" rel="Stylesheet" /><link href="description/Layout.css" type="text/css" rel="Stylesheet" /><link href="description/Brand.css" type="text/css" rel="Stylesheet" />
        <link href="description/iframedescription.css" rel="Stylesheet" type="text/css" />
        <script src="description/offline.js" type="text/javascript"></script>
        <style type="text/css">
            #projectInfo {
                overflow: auto;
            }
            #longDesc {
                clear:both;
                margin: 25px 0 10px 0;
            }

            #SampleIndexList{
                margin-left: 15px;
            }
        </style>
    </head>
<body>
    <div id="offlineDescription">
        <h1>SharePoint 2010: Attaching File from Custom Web View to Outlook Message (Client)</h1>
        <br/>
        <div id="projectInfo">
            <div class="section">
                    <div class="itemBarLong tagsContainer">
                        <label for="Technologies">Technologies</label>
                        <div id="Technologies">
                            SharePoint 2010, Outlook 2010
                        </div>
                    </div>
                    <div class="itemBarLong tagsContainer">
                        <label for="Topics">Topics</label>
                        <div id="Topics">
                            Web View
                        </div>
                    </div>
                <div class="itemBarLong">
                    <label for="Platforms">Platforms</label>
                    <div id="Platforms">
                        Desktop, Cloud
                    </div>
                </div>
                <div class="itemBarLong">
                    <label for="Requirements">Requirements</label>
                    <div id="Requirements">
                        
                    </div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Primary language</label>
                    <div id="LastUpdated">en-US</div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Updated</label>
                    <div id="LastUpdated">4/18/2012</div>
                </div>
                <div class="itemBarLong">
                    <label for="License">License</label>
                    <div id="License">
                        <a href="license.rtf">Apache License, Version 2.0</a></div>
                </div>
                <div class="itemBar">
                    <div class="viewonlinecont">
                        <a data-link="online" href="http://code.msdn.microsoft.com/SharePoint-2010-Attaching-a1738dee">View this sample online</a>
                    </div>
                </div>
            </div>
        </div>
        
                   
<script type="text/javascript">
    function initializePage() {
        var otherTabClass = 'otherTab';
        var hiddenPreClass = 'hidden';

        var htmlDecode = function(encodedData) {
            var decodedData = "";
            if (encodedData) {
                var div = document.createElement('div');
                div.innerHTML = encodedData;
                decodedData = div.firstChild.nodeValue.replace( /\\r\\n/ig , '\r\n');
            }
            return decodedData;
        };
                
        Galleries.iterateElem(Galleries.findElem(null, 'div', 'scriptcode'), function (index, scriptBlock) {
            var titleElem = Galleries.findElem(scriptBlock, 'div', 'title')[0];
            var labelElems = Galleries.findElem(titleElem, 'span');
            if (labelElems.length == 0) {
                labelElems = titleElem;
            }
            var languageSpans = Galleries.findElem(scriptBlock, 'span', 'hidden');
            var pres = Galleries.findElem(scriptBlock, 'pre');
            if (languageSpans.length > 0 && pres.length > 1) {
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    var languageSpan = languageSpans[index];
                            
                    elem.code = codePre.innerHTML.replace( /(\r(\n)?)|((\r)?\n)/ig , '\\r\\n');
                            
                    codePre.className = codePre.className.replace(hiddenPreClass, '');
                            
                    languageSpan.parentNode.removeChild(languageSpan);
                });

                pres = Galleries.findElem(scriptBlock, 'pre');
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    if (index == 0) {
                        scriptBlock.activeTab = 0;
                    }
                    else {
                        labelSpan.className += otherTabClass;
                        codePre.className += hiddenPreClass;
                    }
                    Galleries.attachEventHandler(labelSpan, 'click', function(e) {
                        var activeTab = scriptBlock.activeTab;
                        labelElems[activeTab].className += otherTabClass;
                        pres[activeTab].className += hiddenPreClass;

                        codePre.className = codePre.className.replace(hiddenPreClass, '');
                        labelSpan.className = labelSpan.className.replace(otherTabClass, '');
                        scriptBlock.activeTab = index;
                    });
                });

                var preview = Galleries.findElem(scriptBlock, 'div', 'preview');
                if (preview.length == 0) {
                    preview.push(pres[pres.length - 1]);
                }
                Galleries.iterateElem(preview, function(index, elem) {
                    elem.parentNode.removeChild(elem);
                });

                if (window.clipboardData && clipboardData.setData) {
                    var copyLink = document.createElement('a');
                    copyLink.href = 'javascript:void(0);';
                    copyLink.className = 'copyCode';
                    copyLink.innerHTML = 'Copy code';
                    Galleries.attachEventHandler(copyLink, 'click', function (e) {
                        clipboardData.setData("Text", htmlDecode(labelElems[scriptBlock.activeTab].code));
                        return false;
                    });
                    scriptBlock.insertBefore(copyLink, scriptBlock.childNodes[0]);
                }
            }
        });
    }

    Galleries.onWindowLoad(function(){
        initializePage();
    });

</script>
<div id="longDesc">
    
<h1>Pre-requisites</h1>
<ul>
<li><span style="font-size:small">A SharePoint site installed at the root of a Web Application, with the document id feature turned on (Site Actions-&gt;Site Settings-&gt;Site collection features)</span>
</li></ul>
<p><span style="font-size:small"><img src="description/pre-req1.png" alt="" width="772" height="43"></span></p>
<ul>
<li><span style="font-size:small">Visual Studio 2010</span> </li><li><span style="font-size:small">Outlook 2010</span> <span style="font-size:small">
<strong></strong></span></li></ul>
<p><span style="font-size:small"><strong>Note</strong>: This sample is to be used in conjunction with the corresponding
<a href="http://code.msdn.microsoft.com/SharePoint-2010-Attaching-144821a7">Server sample</a> and the technical article, Attaching Files from a Custom SharePoint WebView to an Outlook Message.</span></p>
<h1><span>Development Technologies Used</span></h1>
<ul>
<li><span style="font-size:small"><a href="http://msdn.microsoft.com/en-us/office/hh133430">VSTO (Visual Studio Tools for Office)</a></span>
</li><li><span style="font-size:small"><a href="http://msdn.microsoft.com/en-us/library/dd30h2yb.aspx">Windows Forms</a></span>
</li></ul>
<p><span style="font-size:20px; font-weight:bold">Solution Overview</span></p>
<p><span style="font-size:small">The <span lang="EN-GB" style="line-height:115%; font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;; font-size:11pt">
solution Outlook.CustomAttachment contains a single VSTO outlook project which targets the .Net 4 Client Profile. The project contains the components for a custom approach to attaching files from SharePoint</span></span><span style="font-size:small">.</span></p>
<h1><span>Installing the Server</span></h1>
<p><span style="font-size:small">Open the Outlook.CustomAttachment solution and click run &ndash; make sure Outlook is not currently running when this is done. Click New Email and then the Attach Document button in the SharePoint group:</span></p>
<p><span style="font-size:small"><img src="description/c-install1.png" alt="" width="183" height="101">&nbsp;</span></p>
<p><strong><span style="font-size:small">When the custom dialog loads it will check the registry for the url of the site it should display</span></strong></p>
<p><strong><span style="font-size:small"><img src="description/c-install2.png" alt="" width="893" height="349">&nbsp;</span></strong><br>
<strong><span style="font-size:small">If it does not find an entry in the registry then the user will be prompted to provide a url, which will then be saved into the registry:</span></strong></p>
<p><strong><span style="font-size:small"><img src="description/c-install3.png" alt="" width="358" height="286">&nbsp;</span></strong><br>
&nbsp;<br>
<span style="font-size:small">The sample will display child document libraries that are set to appear in the QuickLaunch in SharePoint (On the ribbon:
<span style="background-color:#999999">&lsquo;Library&rsquo;-&gt;&rsquo;Library Settings&rsquo;-&gt;&rsquo;Title, Description and Navigation&rsquo;-&gt;&rsquo;Display this document library on the Quick Launch&rsquo;=Yes</span>):</span></p>
<p><span style="font-size:small"><img src="description/c-install4.png" alt="" width="581" height="363">&nbsp;</span><br>
&nbsp;<br>
<span style="font-size:small">Double clicking on a child document library will display the documents in that library. If the document library has versioning turned on and documents with versions in it then they can also be displayed by clicking on the individual
 file&rsquo;s version column:</span></p>
<p><span style="font-size:small"><img src="description/c-install5.png" alt="" width="721" height="574">&nbsp;</span><br>
&nbsp;<br>
<span style="font-size:small">Checking items then clicking the OK button will attach the document to the email.</span><br>
<span style="font-size:small">&nbsp;</span></p>

</div>


    </div>
</body>
</html>

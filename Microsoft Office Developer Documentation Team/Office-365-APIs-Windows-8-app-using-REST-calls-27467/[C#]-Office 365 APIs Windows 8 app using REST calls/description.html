<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head><link rel="stylesheet" type="text/css" href="description/Combined.css,0:HeaderFooterSprite,0:Header.NonMtps,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;hashKey=C9973DA951AE6202C9B348379A1BE49D" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="description/9e116645-9d9a-4566-82a8-7b29a5b324f1Combined.css,0:HeaderFooterSprite,0:Footer.NonMtps,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;hashKey=F576C687BC536B84D6E5B3246EE39B49" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>Office 365 APIs: Windows 8 app using REST calls</title>
        <link href="description/Galleries.css" type="text/css" rel="Stylesheet" /><link href="description/Layout.css" type="text/css" rel="Stylesheet" /><link href="description/Brand.css" type="text/css" rel="Stylesheet" />
        <link href="description/iframedescription.css" rel="Stylesheet" type="text/css" />
        <script src="description/offline.js" type="text/javascript"></script>
        <style type="text/css">
            #projectInfo {
                overflow: auto;
            }
            #longDesc {
                clear:both;
                margin: 25px 0 10px 0;
            }

            #SampleIndexList{
                margin-left: 15px;
            }
        </style>
    </head>
<body>
    <div id="offlineDescription">
        <h1>Office 365 APIs: Windows 8 app using REST calls</h1>
        <br/>
        <div id="projectInfo">
            <div class="section">
                    <div class="itemBarLong tagsContainer">
                        <label for="Technologies">Technologies</label>
                        <div id="Technologies">
                            Sharepoint Online, SharePoint Foundation 2013
                        </div>
                    </div>
                    <div class="itemBarLong tagsContainer">
                        <label for="Topics">Topics</label>
                        <div id="Topics">
                            Microsoft Azure, SharePoint, Exchange
                        </div>
                    </div>
                <div class="itemBarLong">
                    <label for="Platforms">Platforms</label>
                    <div id="Platforms">
                        Cloud
                    </div>
                </div>
                <div class="itemBarLong">
                    <label for="Requirements">Requirements</label>
                    <div id="Requirements">
                        
                    </div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Primary language</label>
                    <div id="LastUpdated">en-US</div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Updated</label>
                    <div id="LastUpdated">5/16/2014</div>
                </div>
                <div class="itemBarLong">
                    <label for="License">License</label>
                    <div id="License">
                        <a href="license.rtf">Apache License, Version 2.0</a></div>
                </div>
                <div class="itemBar">
                    <div class="viewonlinecont">
                        <a data-link="online" href="http://code.msdn.microsoft.com/Office-365-APIs-Get-41eebcdf">View this sample online</a>
                    </div>
                </div>
            </div>
        </div>
        
                   
<script type="text/javascript">
    function initializePage() {
        var otherTabClass = 'otherTab';
        var hiddenPreClass = 'hidden';

        var htmlDecode = function(encodedData) {
            var decodedData = "";
            if (encodedData) {
                var div = document.createElement('div');
                div.innerHTML = encodedData;
                decodedData = div.firstChild.nodeValue.replace( /\\r\\n/ig , '\r\n');
            }
            return decodedData;
        };
                
        Galleries.iterateElem(Galleries.findElem(null, 'div', 'scriptcode'), function (index, scriptBlock) {
            var titleElem = Galleries.findElem(scriptBlock, 'div', 'title')[0];
            var labelElems = Galleries.findElem(titleElem, 'span');
            if (labelElems.length == 0) {
                labelElems = titleElem;
            }
            var languageSpans = Galleries.findElem(scriptBlock, 'span', 'hidden');
            var pres = Galleries.findElem(scriptBlock, 'pre');
            if (languageSpans.length > 0 && pres.length > 1) {
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    var languageSpan = languageSpans[index];
                            
                    elem.code = codePre.innerHTML.replace( /(\r(\n)?)|((\r)?\n)/ig , '\\r\\n');
                            
                    codePre.className = codePre.className.replace(hiddenPreClass, '');
                            
                    languageSpan.parentNode.removeChild(languageSpan);
                });

                pres = Galleries.findElem(scriptBlock, 'pre');
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    if (index == 0) {
                        scriptBlock.activeTab = 0;
                    }
                    else {
                        labelSpan.className += otherTabClass;
                        codePre.className += hiddenPreClass;
                    }
                    Galleries.attachEventHandler(labelSpan, 'click', function(e) {
                        var activeTab = scriptBlock.activeTab;
                        labelElems[activeTab].className += otherTabClass;
                        pres[activeTab].className += hiddenPreClass;

                        codePre.className = codePre.className.replace(hiddenPreClass, '');
                        labelSpan.className = labelSpan.className.replace(otherTabClass, '');
                        scriptBlock.activeTab = index;
                    });
                });

                var preview = Galleries.findElem(scriptBlock, 'div', 'preview');
                if (preview.length == 0) {
                    preview.push(pres[pres.length - 1]);
                }
                Galleries.iterateElem(preview, function(index, elem) {
                    elem.parentNode.removeChild(elem);
                });

                if (window.clipboardData && clipboardData.setData) {
                    var copyLink = document.createElement('a');
                    copyLink.href = 'javascript:void(0);';
                    copyLink.className = 'copyCode';
                    copyLink.innerHTML = 'Copy code';
                    Galleries.attachEventHandler(copyLink, 'click', function (e) {
                        clipboardData.setData("Text", htmlDecode(labelElems[scriptBlock.activeTab].code));
                        return false;
                    });
                    scriptBlock.insertBefore(copyLink, scriptBlock.childNodes[0]);
                }
            }
        });
    }

    Galleries.onWindowLoad(function(){
        initializePage();
    });

</script>
<div id="longDesc">
    
<div id="header">
<table id="bottomTable" cellspacing="0" cellpadding="0">
<tbody>
<tr id="headerTableRow1">
<td align="left"><span id="runningHeaderText">&nbsp;</span></td>
</tr>
<tr id="headerTableRow2">
<td align="left"><span id="nsrTitle">Office 365 APIs: Windows 8 app using REST calls</span></td>
</tr>
</tbody>
</table>
</div>
<div id="mainSection">
<div id="mainBody">
<div>
<p>Office 365 can be accessed via raw REST calls or client libraries. This sample demonstrates how you can use Office 365 APIs with raw REST calls to get contacts (Azure AD), documents (SharePoint), mail, and calendar (Exchange Server) in a Windows 8 application.</p>
</div>
<div>
<p><strong>Last modified: </strong>May 08, 2014</p>
<p><strong>In this article</strong> <br>
<a href="#sectionSection0">Prerequisites</a> <br>
<a href="#sectionSection1">Configure the sample</a> <br>
<a href="#sectionSection2">Register app to consume Office 365 APIs</a> <br>
<a href="#sectionSection3">Build the sample</a> <br>
<a href="#sectionSection4">Run and test the sample</a> <br>
<a href="#sectionSection5">Change log</a> <br>
<a href="#sectionSection6">Related content</a></p>
<p>&nbsp;</p>
<div>
<table cellspacing="0" cellpadding="0" width="100%">
<tbody>
<tr>
<th align="left"><strong>Important</strong> </th>
</tr>
<tr>
<td>
<p><strong>Prerelease content</strong></p>
<p>The features and APIs documented in this article are in preview and are subject to change. Do not use them in production. Your feedback about these features and APIs is important.
<a href="http://officespdev.uservoice.com/" >Let us know</a> what you think. Have questions? Connect with us on
<a href="http://code.msdn.microsoft.com/Office-365-APIs-Get-41eebcdf/https://stackoverflow.com/users/login?returnurl=%2fquestions%2fask%3ftags%3dms-office%2cpreview" >
Stack</a>. Tag your questions with [ms-office].</p>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<h2>Prerequisites</h2>
<div id="sectionSection0">
<p>This sample requires the following:</p>
<ul>
<li>
<p>Visual Studio 2013</p>
</li><li>
<p>Microsoft Azure account with Office 365 tenant.</p>
<div>
<table cellspacing="0" cellpadding="0" width="100%">
<tbody>
<tr>
<th align="left"><strong>Note</strong> </th>
</tr>
<tr>
<td>
<p>For more information to get Office 365 Developer site, see <a href="http://msdn.microsoft.com/library/office/fp179924(v=office.15)" >
Sign up for an Office 365 Developer Site</a></p>
</td>
</tr>
</tbody>
</table>
</div>
</li></ul>
</div>
<h2>Configure the sample</h2>
<div id="sectionSection1">
<p>Follow these steps to configure the sample.</p>
<h3>To configure the sample</h3>
<div>
<ol>
<li>
<p>Open the Windows 8 version of the O365APIsWin8Sample.sln file using Visual Studio 2013.</p>
</li><li>
<p>Register and configure the app to consume Office 365 services.</p>
</li></ol>
</div>
</div>
<h2>Register app to consume Office 365 APIs</h2>
<div id="sectionSection2">
<p>You can do this via the Office 365 API Tools for Visual Studio (which will automate the registration process). Download Office 365 API tools from the
<a href="http://visualstudiogallery.msdn.microsoft.com/7e947621-ef93-4de7-93d3-d796c43ba34f" >
Visual Studio Gallery</a>. Close Visual Studio 2013, then choose the .VSIX file and begin setup. A few moments later, the extension will be installed. Now, just open Visual Studio, and follow along in the walkthrough below.</p>
<ul>
<li>
<p>In the Solution Explorer, choose the project and then choose <strong><span class="ui">Add</span></strong> and choose
<strong><span class="ui">Connected Service</span></strong> as shown in Figure 1.</p>
<strong>
<div class="caption">Figure 1. Add Connected Service</div>
</strong><br>
<img src="description/image.png" alt=""> </li><li>
<p>A Services Manager dialog box will appear as shown in Figure 2. Choose <strong>
<span class="ui">Office 365</span></strong> and sign in.</p>
<strong>
<div class="caption">Figure 2. Services Manager</div>
</strong><br>
<img src="description/74a06248-a9de-4dcc-955b-4a39407dc350image.png" alt=""> </li><li>
<p>On the sign-in dialog box, enter the username and password for your Office 365 tenant as shown in Figure 3. We recommend that you use your Office 365 Developer Site. Often, this user name will follow the pattern &lt;your-name&gt;@&lt;tenant-name&gt;.onmicrosoft.com.
 If you do not have a developer site, you can get a free Developer Site as part of your
<a href="http://msdn.microsoft.com/library/fp179924%28v=office.15%29.aspx" >
MSDN Benefits</a> or sign up for a free trial. Be aware that the user must be an admin user&mdash;but for tenants created as part of an Office 365 Developer Site, this is likely to be the case already.</p>
<strong>
<div class="caption">Figure 3. Windows Azure active directory</div>
</strong><br>
<img src="description/fb01af01-a0a8-4139-8c11-4a268323fc59image.png" alt=""> </li><li>
<p>After you're signed in, you will see a list of all the services. Initially, no permissions will be selected &mdash;as the app is not registered to consume any services yet.</p>
<p>&nbsp;</p>
</li><li>
<p>Choose the following permissions for this sample -</p>
<ul>
<li>
<p>Windows Azure Active Directory Graph permissions - User Profile permission</p>
</li><li>
<p>Exchange Server permissions - Contacts, Calendar, and Mail permissions</p>
</li><li>
<p>SharePoint permissions - use AllSites, and ONLY &quot;Read items in all site collections&quot; or &quot;Edit or delete items in all site collections&quot; permissions.</p>
</li></ul>
<div>
<table cellspacing="0" cellpadding="0" width="100%">
<tbody>
<tr>
<th align="left"><strong>Note</strong> </th>
</tr>
<tr>
<td>
<p>In addition to registering your app, the Connected Services Manager will also add additional NuGet libraries, Client Libraries, and sample code to your project. However, the existing sample will still run as is.</p>
</td>
</tr>
</tbody>
</table>
</div>
</li></ul>
</div>
<h2>Build the sample</h2>
<div id="sectionSection3">
<p>Press <strong><span class="ui">F5</span></strong> to build and debug.</p>
</div>
<h2>Run and test the sample</h2>
<div id="sectionSection4">
<p>The final step is to run the sample and test the results.</p>
<h3>To run the sample:</h3>
<div>
<ul>
<li>
<p>Run the solution and Sign-In with your Organizational Account to Office 365.</p>
</li></ul>
</div>
</div>
<h2>Change log</h2>
<div id="sectionSection5"><strong>
<div class="caption"></div>
</strong>
<div>
<table cellspacing="2" cellpadding="5" width="50%" frame="lhs">
<tbody>
<tr>
<th>
<p>Version</p>
</th>
<th>
<p>Date</p>
</th>
</tr>
<tr>
<td>
<p>Second version</p>
</td>
<td>
<p>May 2014</p>
</td>
</tr>
<tr>
<td>
<p>First version</p>
</td>
<td>
<p>March 2014</p>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<h2>Related content</h2>
<div id="sectionSection6">
<ul>
<li>
<p><a href="http://msdn.microsoft.com/en-us/library/d93d8591-c312-470a-b5f2-fa7a0fd57021" >Overview of Discovery Service</a></p>
</li><li>
<p><a href="http://msdn.microsoft.com/EN-US/library/office/376090cb-f038-4b93-bddf-231403dc4a09" >Overview of Office 365 APIs Preview</a></p>
</li><li>
<p><a href="http://visualstudiogallery.msdn.microsoft.com/7e947621-ef93-4de7-93d3-d796c43ba34f" >Office 365 API Tools - Preview</a></p>
</li><li>
<p><a href="http://blogs.msdn.com/b/officeapps/archive/2014/03/12/announcing-office-365-api-tools-for-visual-studio-preview.aspx" >(Blog)Announcing Office 365 API Tools for Visual Studio &mdash; Preview</a></p>
</li><li>
<p><a href="http://msdn.microsoft.com/en-us/library/office/dn605894.aspx" >How to: Integrate O365 with a web server app using Common Consent Framework</a></p>
</li><li>
<p><a href="http://msdn.microsoft.com/en-us/library/office/dn605896.aspx" >Using the Mail, Calendar, and Contact REST APIs to work with emails, calendar items, and contacts
</a></p>
</li><li>
<p><a href="http://msdn.microsoft.com/en-us/office/aa905340" >Office dev center - Introducing Office 365 APIs</a></p>
</li></ul>
</div>
</div>
</div>
<p>&nbsp;</p>

</div>


    </div>
</body>
</html>
